<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Sequel::Plugins::AssociationLazyEagerOption - Sequel: The Database Toolkit for Ruby</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/navigation.js" defer></script>
<script src="../../js/search.js" defer></script>
<script src="../../js/search_index.js" defer></script>
<script src="../../js/searcher.js" defer></script>
<script src="../../js/darkfish.js" defer></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    
  </div>
</nav>

<main role="main" aria-labelledby="module-Sequel::Plugins::AssociationLazyEagerOption">
  <h1 id="module-Sequel::Plugins::AssociationLazyEagerOption" class="module">
    module Sequel::Plugins::AssociationLazyEagerOption
  </h1>

  <section class="description">
    
<p>The association_lazy_eager_option plugin supports passing an <code>:eager</code> option to an association method.  If the related association is already cached, the cached version will be returned.  If the association is not already cached, it will be loaded, and the value of the <code>:eager</code> option will be used to perform an eager load of the given associations. the plural versions.</p>

<p>With Sequel&#39;s default behavior, you can already perform an eager load when lazy loading using a block:</p>

<pre class="ruby"><span class="ruby-identifier">obj</span>.<span class="ruby-identifier">association</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">ds</span><span class="ruby-operator">|</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">eager</span>(<span class="ruby-value">:nested_association</span>)}
</pre>

<p>However, this will ignore any cached version.  In more complex software, the association may already be cached and have the nested association cached inside of it, and using this callback approach then requires 2 unnecessary queries. This plugin will not perform any queries if the association is already cached, preventing duplicate work. However, you should make sure that an already loaded association has the nested association already eagerly loaded.</p>

<p>Usage:</p>

<pre class="ruby"><span class="ruby-comment"># Make all model subclasses support the :eager association</span>
<span class="ruby-comment"># method option (called before loading subclasses)</span>
<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:association_lazy_eager_option</span>

<span class="ruby-comment"># Make the Album class support the :eager association</span>
<span class="ruby-comment"># method option</span>
<span class="ruby-constant">Album</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:association_lazy_eager_option</span>
</pre>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
  </section>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.1.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

