<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Sequel::Plugins::ThrowFailures - Sequel: The Database Toolkit for Ruby</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/navigation.js" defer></script>
<script src="../../js/search.js" defer></script>
<script src="../../js/search_index.js" defer></script>
<script src="../../js/searcher.js" defer></script>
<script src="../../js/darkfish.js" defer></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    
  </div>
</nav>

<main role="main" aria-labelledby="module-Sequel::Plugins::ThrowFailures">
  <h1 id="module-Sequel::Plugins::ThrowFailures" class="module">
    module Sequel::Plugins::ThrowFailures
  </h1>

  <section class="description">
    
<p>The throw_failures plugin throws HookFailed and ValidationFailed exceptions instead of raising them.  If there is no matching catch block, the UncaughtThrowError will be rescued and the HookFailed or ValidationFailed exception will be raised normally.</p>

<p>If you are setting up the catch blocks to handle these failures, in the failure case this plugin is about 10-15% faster on CRuby and 10x faster on JRuby.  If you are not setting up the catch blocks, in the failure case this plugin is about 30% slower on CRuby and 2x slower on JRuby.  So this plugin should only be used if you are setting up catch blocks manually.</p>

<p>This plugin will setup catch blocks automatically for internally rescued HookFailed exceptions when the model is configured to not raise exceptions on failure (by default, the exceptions are internally rescued in that case.</p>

<p>To set up the catch blocks, use the class of the exception:</p>

<pre class="ruby"><span class="ruby-identifier">ret</span> = <span class="ruby-identifier">catch</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">ValidationFailed</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">model_instance</span>.<span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span>
<span class="ruby-keyword">if</span> <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">ValidationFailed</span>)
  <span class="ruby-comment"># handle failure</span>
<span class="ruby-keyword">else</span>
  <span class="ruby-comment"># handle success</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Usage:</p>

<pre class="ruby"><span class="ruby-comment"># Make all model subclass instances throw HookFailed and ValidationFailed exceptions</span>
<span class="ruby-comment"># (called before loading subclasses)</span>
<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:throw_failures</span>

<span class="ruby-comment"># Make the Album class throw HookFailed and ValidationFailed exceptions</span>
<span class="ruby-constant">Album</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:throw_failures</span>
</pre>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
  </section>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.1.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

