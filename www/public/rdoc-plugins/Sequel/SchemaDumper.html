<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Sequel::SchemaDumper - Sequel: The Database Toolkit for Ruby</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/navigation.js" defer></script>
<script src="../js/search.js" defer></script>
<script src="../js/search_index.js" defer></script>
<script src="../js/searcher.js" defer></script>
<script src="../js/darkfish.js" defer></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-column_schema_to_ruby_type">#column_schema_to_ruby_type</a>
    
    <li ><a href="#method-i-dump_foreign_key_migration">#dump_foreign_key_migration</a>
    
    <li ><a href="#method-i-dump_indexes_migration">#dump_indexes_migration</a>
    
    <li ><a href="#method-i-dump_schema_migration">#dump_schema_migration</a>
    
    <li ><a href="#method-i-dump_table_schema">#dump_table_schema</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Sequel::SchemaDumper">
  <h1 id="module-Sequel::SchemaDumper" class="module">
    module Sequel::SchemaDumper
  </h1>

  <section class="description">
    
  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-column_schema_to_ruby_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">column_schema_to_ruby_type</span><span
            class="method-args">(schema)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Convert the column schema information to a hash of column options, one of which must be :type.  The other options added should modify that type (e.g. :size).  If a database type is not recognized, return it as a <a href="../String.html"><code>String</code></a> type.</p>
          
          

          
          <div class="method-source-code" id="column_schema_to_ruby_type-source">
            <pre>   <span class="ruby-comment"># File lib/sequel/extensions/schema_dumper.rb</span>
<span class="line-num">33</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">column_schema_to_ruby_type</span>(<span class="ruby-identifier">schema</span>)
<span class="line-num">34</span>   <span class="ruby-identifier">type</span> = <span class="ruby-identifier">schema</span>[<span class="ruby-value">:db_type</span>].<span class="ruby-identifier">downcase</span>
<span class="line-num">35</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:oracle</span>
<span class="line-num">36</span>     <span class="ruby-identifier">type</span> = <span class="ruby-identifier">type</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/ not null\z/</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="line-num">37</span>   <span class="ruby-keyword">end</span>
<span class="line-num">38</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">type</span>
<span class="line-num">39</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(medium|small)?int(?:eger)?(?:\((\d+)\))?( unsigned)?\z/</span>
<span class="line-num">40</span>     <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-node">$1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-node">$2</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-node">$2</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">10</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-node">$3</span>
<span class="line-num">41</span>       <span class="ruby-comment"># Unsigned integer type with 10 digits can potentially contain values which</span>
<span class="line-num">42</span>       <span class="ruby-comment"># don&#39;t fit signed integer type, so use bigint type in target database.</span>
<span class="line-num">43</span>       {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:Bignum</span>}
<span class="line-num">44</span>     <span class="ruby-keyword">else</span>
<span class="line-num">45</span>       {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Integer</span>}
<span class="line-num">46</span>     <span class="ruby-keyword">end</span>
<span class="line-num">47</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\Atinyint(?:\((\d+)\))?(?: unsigned)?\z/</span>
<span class="line-num">48</span>     {<span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span><span class="ruby-identifier">schema</span>[<span class="ruby-value">:type</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:boolean</span> <span class="ruby-operator">?</span> <span class="ruby-constant">TrueClass</span> <span class="ruby-operator">:</span> <span class="ruby-constant">Integer</span>}
<span class="line-num">49</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\Abigint(?:\((?:\d+)\))?(?: unsigned)?\z/</span>
<span class="line-num">50</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:Bignum</span>}
<span class="line-num">51</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(?:real|float|double(?: precision)?|double\(\d+,\d+\))(?: unsigned)?\z/</span>
<span class="line-num">52</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Float</span>}
<span class="line-num">53</span>   <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;boolean&#39;</span>, <span class="ruby-string">&#39;bit&#39;</span>, <span class="ruby-string">&#39;bool&#39;</span>
<span class="line-num">54</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">TrueClass</span>}
<span class="line-num">55</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(?:(?:tiny|medium|long|n)?text|clob)\z/</span>
<span class="line-num">56</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">String</span>, <span class="ruby-value">:text</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>}
<span class="line-num">57</span>   <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;date&#39;</span>
<span class="line-num">58</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Date</span>}
<span class="line-num">59</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(?:small)?datetime\z/</span>
<span class="line-num">60</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">DateTime</span>}
<span class="line-num">61</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\Atimestamp(?:\((\d+)\))?(?: with(?:out)? time zone)?\z/</span>
<span class="line-num">62</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">DateTime</span>, <span class="ruby-value">:size</span><span class="ruby-operator">=&gt;</span>(<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-node">$1</span>)}
<span class="line-num">63</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\Atime(?: with(?:out)? time zone)?\z/</span>
<span class="line-num">64</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Time</span>, <span class="ruby-value">:only_time</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>}
<span class="line-num">65</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\An?char(?:acter)?(?:\((\d+)\))?\z/</span>
<span class="line-num">66</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">String</span>, <span class="ruby-value">:size</span><span class="ruby-operator">=&gt;</span>(<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-node">$1</span>), <span class="ruby-value">:fixed</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>}
<span class="line-num">67</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(?:n?varchar2?|character varying|bpchar|string)(?:\((\d+)\))?\z/</span>
<span class="line-num">68</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">String</span>, <span class="ruby-value">:size</span><span class="ruby-operator">=&gt;</span>(<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-node">$1</span>)}
<span class="line-num">69</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(?:small)?money\z/</span>
<span class="line-num">70</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">BigDecimal</span>, <span class="ruby-value">:size</span><span class="ruby-operator">=&gt;</span>[<span class="ruby-value">19</span>,<span class="ruby-value">2</span>]}
<span class="line-num">71</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(?:decimal|numeric|number)(?:\((\d+)(?:,\s*(\d+))?\))?(?: unsigned)?\z/</span>
<span class="line-num">72</span>     <span class="ruby-identifier">s</span> = [(<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-node">$1</span>), (<span class="ruby-node">$2</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-node">$2</span>)].<span class="ruby-identifier">compact</span>
<span class="line-num">73</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">BigDecimal</span>, <span class="ruby-value">:size</span><span class="ruby-operator">=&gt;</span>(<span class="ruby-identifier">s</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">s</span>)}
<span class="line-num">74</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(?:bytea|(?:tiny|medium|long)?blob|(?:var)?binary)(?:\((\d+)\))?\z/</span>
<span class="line-num">75</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">File</span>, <span class="ruby-value">:size</span><span class="ruby-operator">=&gt;</span>(<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-keyword">if</span> <span class="ruby-node">$1</span>)}
<span class="line-num">76</span>   <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A(?:year|(?:int )?identity)\z/</span>
<span class="line-num">77</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Integer</span>}
<span class="line-num">78</span>   <span class="ruby-keyword">else</span>
<span class="line-num">79</span>     {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">String</span>}
<span class="line-num">80</span>   <span class="ruby-keyword">end</span>
<span class="line-num">81</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dump_foreign_key_migration" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dump_foreign_key_migration</span><span
            class="method-args">(options=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Dump foreign key constraints for all tables as a migration. This complements the foreign_keys: false option to dump_schema_migration. This only dumps the constraints (not the columns) using alter_table/add_foreign_key with an array of columns.</p>

<p>Note that the migration this produces does not have a down block, so you cannot reverse it.</p>
          
          

          
          <div class="method-source-code" id="dump_foreign_key_migration-source">
            <pre>   <span class="ruby-comment"># File lib/sequel/extensions/schema_dumper.rb</span>
<span class="line-num">90</span>     <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">dump_foreign_key_migration</span>(<span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">91</span>       <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">tables</span>(<span class="ruby-identifier">options</span>)
<span class="line-num">92</span>       <span class="ruby-identifier">&lt;&lt;END_MIG</span>
<span class="line-num">93</span> <span class="ruby-value">Sequel.migration do
<span class="line-num">94</span>   change do
<span class="line-num">95</span> #{ts.sort.map{|t| dump_table_foreign_keys(t)}.reject{|x| x == &#39;&#39;}.join(&quot;\n\n&quot;).gsub(/^/, &#39;    &#39;)}
<span class="line-num">96</span>   end
<span class="line-num">97</span> end
<span class="line-num">98</span> </span><span class="ruby-identifier">END_MIG</span>
<span class="line-num">99</span>     <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dump_indexes_migration" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dump_indexes_migration</span><span
            class="method-args">(options=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Dump indexes for all tables as a migration.  This complements the indexes: false option to dump_schema_migration. Options:</p>
<dl class="rdoc-list note-list"><dt>:same_db 
<dd>
<p>Create a dump for the same database type, so don&#39;t ignore errors if the index statements fail.</p>
</dd><dt>:index_names 
<dd>
<p>If set to false, don&#39;t record names of indexes. If set to :namespace, prepend the table name to the index name if the database does not use a global index namespace.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="dump_indexes_migration-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/extensions/schema_dumper.rb</span>
<span class="line-num">108</span>     <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">dump_indexes_migration</span>(<span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">109</span>       <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">tables</span>(<span class="ruby-identifier">options</span>)
<span class="line-num">110</span>       <span class="ruby-identifier">&lt;&lt;END_MIG</span>
<span class="line-num">111</span> <span class="ruby-value">Sequel.migration do
<span class="line-num">112</span>   change do
<span class="line-num">113</span> #{ts.sort.map{|t| dump_table_indexes(t, :add_index, options)}.reject{|x| x == &#39;&#39;}.join(&quot;\n\n&quot;).gsub(/^/, &#39;    &#39;)}
<span class="line-num">114</span>   end
<span class="line-num">115</span> end
<span class="line-num">116</span> </span><span class="ruby-identifier">END_MIG</span>
<span class="line-num">117</span>     <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dump_schema_migration" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dump_schema_migration</span><span
            class="method-args">(options=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a string that contains a <a href="../Sequel.html"><code>Sequel</code></a> migration that when run would recreate the database structure. Options:</p>
<dl class="rdoc-list note-list"><dt>:same_db 
<dd>
<p>Don&#39;t attempt to translate database types to ruby types. If this isn&#39;t set to true, all database types will be translated to ruby types, but there is no guarantee that the migration generated will yield the same type.  Without this set, types that aren&#39;t recognized will be translated to a string-like type.</p>
</dd><dt>:foreign_keys 
<dd>
<p>If set to false, don&#39;t dump foreign_keys (they can be added later via <a href="SchemaDumper.html#method-i-dump_foreign_key_migration"><code>dump_foreign_key_migration</code></a>)</p>
</dd><dt>:indexes 
<dd>
<p>If set to false, don&#39;t dump indexes (they can be added later via dump_index_migration).</p>
</dd><dt>:index_names 
<dd>
<p>If set to false, don&#39;t record names of indexes. If set to :namespace, prepend the table name to the index name.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="dump_schema_migration-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/extensions/schema_dumper.rb</span>
<span class="line-num">132</span>     <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">dump_schema_migration</span>(<span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">133</span>       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>
<span class="line-num">134</span>       <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:indexes</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:foreign_keys</span>)
<span class="line-num">135</span>         <span class="ruby-comment"># Unless foreign_keys option is specifically set, disable if indexes</span>
<span class="line-num">136</span>         <span class="ruby-comment"># are disabled, as foreign keys that point to non-primary keys rely</span>
<span class="line-num">137</span>         <span class="ruby-comment"># on unique indexes being created first</span>
<span class="line-num">138</span>         <span class="ruby-identifier">options</span>[<span class="ruby-value">:foreign_keys</span>] = <span class="ruby-keyword">false</span>
<span class="line-num">139</span>       <span class="ruby-keyword">end</span>
<span class="line-num">140</span> 
<span class="line-num">141</span>       <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">sort_dumped_tables</span>(<span class="ruby-identifier">tables</span>(<span class="ruby-identifier">options</span>), <span class="ruby-identifier">options</span>)
<span class="line-num">142</span>       <span class="ruby-identifier">skipped_fks</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">sfk</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:skipped_foreign_keys</span>]
<span class="line-num">143</span>         <span class="ruby-comment"># Handle skipped foreign keys by adding them at the end via</span>
<span class="line-num">144</span>         <span class="ruby-comment"># alter_table/add_foreign_key.  Note that skipped foreign keys</span>
<span class="line-num">145</span>         <span class="ruby-comment"># probably result in a broken down migration.</span>
<span class="line-num">146</span>         <span class="ruby-identifier">sfka</span> = <span class="ruby-identifier">sfk</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">table</span>, <span class="ruby-identifier">fks</span><span class="ruby-operator">|</span> <span class="ruby-identifier">dump_add_fk_constraints</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">fks</span>.<span class="ruby-identifier">values</span>)}
<span class="line-num">147</span>         <span class="ruby-identifier">sfka</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n\n&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^/</span>, <span class="ruby-string">&#39;    &#39;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sfka</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">148</span>       <span class="ruby-keyword">end</span>
<span class="line-num">149</span> 
<span class="line-num">150</span>       <span class="ruby-identifier">&lt;&lt;END_MIG</span>
<span class="line-num">151</span> <span class="ruby-value">Sequel.migration do
<span class="line-num">152</span>   change do
<span class="line-num">153</span> #{ts.map{|t| dump_table_schema(t, options)}.join(&quot;\n\n&quot;).gsub(/^/, &#39;    &#39;)}#{&quot;\n    \n&quot; if skipped_fks}#{skipped_fks}
<span class="line-num">154</span>   end
<span class="line-num">155</span> end
<span class="line-num">156</span> </span><span class="ruby-identifier">END_MIG</span>
<span class="line-num">157</span>     <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-dump_table_schema" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dump_table_schema</span><span
            class="method-args">(table, options=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a string with a create table block that will recreate the given table&#39;s schema.  Takes the same options as dump_schema_migration.</p>
          
          

          
          <div class="method-source-code" id="dump_table_schema-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/extensions/schema_dumper.rb</span>
<span class="line-num">161</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">dump_table_schema</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">162</span>   <span class="ruby-identifier">gen</span> = <span class="ruby-identifier">dump_table_generator</span>(<span class="ruby-identifier">table</span>, <span class="ruby-identifier">options</span>)
<span class="line-num">163</span>   <span class="ruby-identifier">commands</span> = [<span class="ruby-identifier">gen</span>.<span class="ruby-identifier">dump_columns</span>, <span class="ruby-identifier">gen</span>.<span class="ruby-identifier">dump_constraints</span>, <span class="ruby-identifier">gen</span>.<span class="ruby-identifier">dump_indexes</span>].<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span>}.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n\n&quot;</span>)
<span class="line-num">164</span>   <span class="ruby-node">&quot;create_table(#{table.inspect}#{&#39;, :ignore_index_errors=&gt;true&#39; if !options[:same_db] &amp;&amp; options[:indexes] != false &amp;&amp; !gen.indexes.empty?}) do\n#{commands.gsub(/^/, &#39;  &#39;)}\nend&quot;</span>
<span class="line-num">165</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.1.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

