<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Sequel::Schema::AlterTableGenerator - Sequel: The Database Toolkit for Ruby</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/navigation.js" defer></script>
<script src="../../js/search.js" defer></script>
<script src="../../js/search_index.js" defer></script>
<script src="../../js/searcher.js" defer></script>
<script src="../../js/darkfish.js" defer></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-add_column">#add_column</a>
    
    <li ><a href="#method-i-add_constraint">#add_constraint</a>
    
    <li ><a href="#method-i-add_foreign_key">#add_foreign_key</a>
    
    <li ><a href="#method-i-add_full_text_index">#add_full_text_index</a>
    
    <li ><a href="#method-i-add_index">#add_index</a>
    
    <li ><a href="#method-i-add_primary_key">#add_primary_key</a>
    
    <li ><a href="#method-i-add_spatial_index">#add_spatial_index</a>
    
    <li ><a href="#method-i-add_unique_constraint">#add_unique_constraint</a>
    
    <li ><a href="#method-i-drop_column">#drop_column</a>
    
    <li ><a href="#method-i-drop_constraint">#drop_constraint</a>
    
    <li ><a href="#method-i-drop_foreign_key">#drop_foreign_key</a>
    
    <li ><a href="#method-i-drop_index">#drop_index</a>
    
    <li ><a href="#method-i-rename_column">#rename_column</a>
    
    <li ><a href="#method-i-set_column_allow_null">#set_column_allow_null</a>
    
    <li ><a href="#method-i-set_column_default">#set_column_default</a>
    
    <li ><a href="#method-i-set_column_not_null">#set_column_not_null</a>
    
    <li ><a href="#method-i-set_column_type">#set_column_type</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Sequel::Schema::AlterTableGenerator">
  <h1 id="class-Sequel::Schema::AlterTableGenerator" class="class">
    class Sequel::Schema::AlterTableGenerator
  </h1>

  <section class="description">
    
<p><a href="AlterTableGenerator.html"><code>Schema::AlterTableGenerator</code></a> is an internal class that the user is not expected to instantiate directly.  Instances are created by <a href="../Database.html#method-i-alter_table"><code>Database#alter_table</code></a>. It is used to specify table alteration parameters.  It takes a <a href="../Database.html"><code>Database</code></a> object and a block of operations to perform on the table, and gives the <a href="../Database.html"><code>Database</code></a> an array of table altering operations, which the database uses to alter a table&#39;s description.</p>

<p>For more information on Sequel&#39;s support for schema modification, see the <a href="../../files/doc/schema_modification_rdoc.html">“Schema Modification” guide</a>.</p>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-operations" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">operations</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>An array of operations to perform</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(db, &amp;block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set the <a href="../Database.html"><code>Database</code></a> object to which to apply the changes, and evaluate the block in the context of this object.</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">383</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">db</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">384</span>   <span class="ruby-ivar">@db</span> = <span class="ruby-identifier">db</span>
<span class="line-num">385</span>   <span class="ruby-ivar">@operations</span> = []
<span class="line-num">386</span>   <span class="ruby-identifier">instance_exec</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
<span class="line-num">387</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-add_column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_column</span><span
            class="method-args">(name, type, opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a column with the given name, type, and opts. See <a href="CreateTableGenerator.html#method-i-column"><code>CreateTableGenerator#column</code></a> for the available options (except for <code>:index</code>, use a separate <code>add_index</code> call to add an index for the column).</p>

<pre class="ruby"><span class="ruby-identifier">add_column</span>(<span class="ruby-value">:name</span>, <span class="ruby-constant">String</span>) <span class="ruby-comment"># ADD COLUMN name varchar(255)</span>
</pre>

<p>PostgreSQL specific options:</p>
<dl class="rdoc-list note-list"><dt>:if_not_exists 
<dd>
<p>Set to true to not add the column if it already exists (PostgreSQL 9.6+)</p>
</dd></dl>

<p>MySQL specific options:</p>
<dl class="rdoc-list note-list"><dt>:after 
<dd>
<p>The name of an existing column that the new column should be positioned after</p>
</dd><dt>:first 
<dd>
<p>Create this new column before all other existing columns</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="add_column-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">403</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">404</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:add_column</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">type</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">405</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">406</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_constraint" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_constraint</span><span
            class="method-args">(name, *args, &amp;block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a constraint with the given name and args. See <a href="CreateTableGenerator.html#method-i-constraint"><code>CreateTableGenerator#constraint</code></a>.</p>

<pre class="ruby"><span class="ruby-identifier">add_constraint</span>(<span class="ruby-value">:valid_name</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">like</span>(<span class="ruby-value">:name</span>, <span class="ruby-string">&#39;A%&#39;</span>))
<span class="ruby-comment"># ADD CONSTRAINT valid_name CHECK (name LIKE &#39;A%&#39; ESCAPE &#39;\&#39;)</span>
<span class="ruby-identifier">add_constraint</span>({<span class="ruby-value">name:</span> <span class="ruby-value">:valid_name</span>, <span class="ruby-value">deferrable:</span> <span class="ruby-keyword">true</span>}, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">like</span>(<span class="ruby-value">:name</span>, <span class="ruby-string">&#39;A%&#39;</span>))
<span class="ruby-comment"># ADD CONSTRAINT valid_name CHECK (name LIKE &#39;A%&#39; ESCAPE &#39;\&#39;) DEFERRABLE INITIALLY DEFERRED</span>
</pre>
          
          

          
          <div class="method-source-code" id="add_constraint-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">415</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_constraint</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">416</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">:</span> {<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">name</span>}
<span class="line-num">417</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:op</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:add_constraint</span>, <span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:check</span>, <span class="ruby-value">:check</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">block</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">args</span>)
<span class="line-num">418</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">419</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_foreign_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_foreign_key</span><span
            class="method-args">(name, table, opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a foreign key with the given name and referencing the given table. See <a href="CreateTableGenerator.html#method-i-column"><code>CreateTableGenerator#column</code></a> for the available options (except for <code>:index</code>, use a separate <code>add_index</code> call to add an index for the column).</p>

<p>You can also pass an array of column names for creating composite foreign keys. In this case, it will assume the columns exist and will only add the constraint.  You can provide a :name option to name the constraint.</p>

<p>NOTE: If you need to add a foreign key constraint to a single existing column use the composite key syntax even if it is only one column.</p>

<pre class="ruby"><span class="ruby-identifier">add_foreign_key</span>(<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:table</span>) <span class="ruby-comment"># ADD COLUMN artist_id integer REFERENCES table</span>
<span class="ruby-identifier">add_foreign_key</span>([<span class="ruby-value">:name</span>], <span class="ruby-value">:table</span>) <span class="ruby-comment"># ADD FOREIGN KEY (name) REFERENCES table</span>
</pre>

<p>PostgreSQL specific options:</p>
<dl class="rdoc-list note-list"><dt>:not_valid 
<dd>
<p>Set to true to add the constraint with the NOT VALID syntax. This makes it so that future inserts must respect referential integrity, but allows the constraint to be added even if existing column values reference rows that do not exist.  After all the existing data has been cleaned up, validate_constraint can be used to mark the constraint as valid.  Note that this option only makes sense when using an array of columns.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="add_foreign_key-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">455</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_foreign_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">456</span>   <span class="ruby-keyword">return</span> <span class="ruby-identifier">add_composite_foreign_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">457</span>   <span class="ruby-identifier">add_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">Integer</span>, {<span class="ruby-value">:table</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">table</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">458</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_full_text_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_full_text_index</span><span
            class="method-args">(columns, opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a full text index on the given columns. See <a href="CreateTableGenerator.html#method-i-full_text_index"><code>CreateTableGenerator#full_text_index</code></a> for available options.</p>
          
          

          
          <div class="method-source-code" id="add_full_text_index-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">462</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_full_text_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">463</span>   <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">columns</span>, {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:full_text</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">464</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_index</span><span
            class="method-args">(columns, opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add an index on the given columns. See <a href="CreateTableGenerator.html#method-i-index"><code>CreateTableGenerator#index</code></a> for available options.</p>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># CREATE INDEX table_artist_id_index ON table (artist_id)</span>
</pre>
          
          

          
          <div class="method-source-code" id="add_index-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">470</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">471</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:add_index</span>, <span class="ruby-value">:columns</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>)}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">472</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">473</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_primary_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_primary_key</span><span
            class="method-args">(name, opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a primary key.  See <a href="CreateTableGenerator.html#method-i-column"><code>CreateTableGenerator#column</code></a> for the available options.  Like <code>add_foreign_key</code>, if you specify the column name as an array, it just creates a constraint:</p>

<pre class="ruby"><span class="ruby-identifier">add_primary_key</span>(<span class="ruby-value">:id</span>) <span class="ruby-comment"># ADD COLUMN id serial PRIMARY KEY</span>
<span class="ruby-identifier">add_primary_key</span>([<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:name</span>]) <span class="ruby-comment"># ADD PRIMARY KEY (artist_id, name)</span>
</pre>
          
          

          
          <div class="method-source-code" id="add_primary_key-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">481</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_primary_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">482</span>   <span class="ruby-keyword">return</span> <span class="ruby-identifier">add_composite_primary_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">483</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">serial_primary_key_options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">484</span>   <span class="ruby-identifier">add_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:type</span>), <span class="ruby-identifier">opts</span>)
<span class="line-num">485</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_spatial_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_spatial_index</span><span
            class="method-args">(columns, opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a spatial index on the given columns. See <a href="CreateTableGenerator.html#method-i-index"><code>CreateTableGenerator#index</code></a> for available options.</p>
          
          

          
          <div class="method-source-code" id="add_spatial_index-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">489</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_spatial_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">490</span>   <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">columns</span>, {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:spatial</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">491</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_unique_constraint" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_unique_constraint</span><span
            class="method-args">(columns, opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a unique constraint to the given column(s)</p>

<pre class="ruby"><span class="ruby-identifier">add_unique_constraint</span>(<span class="ruby-value">:name</span>) <span class="ruby-comment"># ADD UNIQUE (name)</span>
<span class="ruby-identifier">add_unique_constraint</span>(<span class="ruby-value">:name</span>, <span class="ruby-value">name:</span> <span class="ruby-value">:unique_name</span>) <span class="ruby-comment"># ADD CONSTRAINT unique_name UNIQUE (name)</span>
</pre>

<p>Supports the same :deferrable option as <a href="CreateTableGenerator.html#method-i-column"><code>CreateTableGenerator#column</code></a>.</p>
          
          

          
          <div class="method-source-code" id="add_unique_constraint-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">427</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_unique_constraint</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">428</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:add_constraint</span>, <span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:unique</span>, <span class="ruby-value">:columns</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>)}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">429</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">430</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-drop_column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">drop_column</span><span
            class="method-args">(name, opts=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Remove a column from the table.</p>

<pre class="ruby"><span class="ruby-identifier">drop_column</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># DROP COLUMN artist_id</span>
<span class="ruby-identifier">drop_column</span>(<span class="ruby-value">:artist_id</span>, <span class="ruby-value">cascade:</span> <span class="ruby-keyword">true</span>) <span class="ruby-comment"># DROP COLUMN artist_id CASCADE</span>
</pre>

<p>Options:</p>
<dl class="rdoc-list note-list"><dt>:cascade 
<dd>
<p>CASCADE the operation, dropping other objects that depend on the dropped column.</p>
</dd></dl>

<p>PostgreSQL specific options:</p>
<dl class="rdoc-list note-list"><dt>:if_exists 
<dd>
<p>Use IF EXISTS, so no error is raised if the column does not exist.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="drop_column-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">506</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">drop_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">507</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:drop_column</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">508</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">509</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-drop_constraint" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">drop_constraint</span><span
            class="method-args">(name, opts=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Remove a constraint from the table:</p>

<pre class="ruby"><span class="ruby-identifier">drop_constraint</span>(<span class="ruby-value">:unique_name</span>) <span class="ruby-comment"># DROP CONSTRAINT unique_name</span>
<span class="ruby-identifier">drop_constraint</span>(<span class="ruby-value">:unique_name</span>, <span class="ruby-value">cascade:</span> <span class="ruby-keyword">true</span>) <span class="ruby-comment"># DROP CONSTRAINT unique_name CASCADE</span>
</pre>

<p>MySQL/SQLite specific options:</p>
<dl class="rdoc-list note-list"><dt>:type 
<dd>
<p>Set the type of constraint to drop, either :primary_key, :foreign_key, or :unique.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="drop_constraint-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">520</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">drop_constraint</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">521</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:drop_constraint</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">522</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">523</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-drop_foreign_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">drop_foreign_key</span><span
            class="method-args">(name, opts=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Remove a foreign key and the associated column from the table. General options:</p>
<dl class="rdoc-list note-list"><dt>:name 
<dd>
<p>The name of the constraint to drop.  If not given, uses the same name that would be used by <a href="AlterTableGenerator.html#method-i-add_foreign_key"><code>add_foreign_key</code></a> with the same columns.</p>
</dd></dl>

<p>NOTE: If you want to drop only the foreign key constraint but keep the column, use the composite key syntax even if it is only one column.</p>

<pre class="ruby"><span class="ruby-identifier">drop_foreign_key</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># DROP CONSTRAINT table_artist_id_fkey, DROP COLUMN artist_id</span>
<span class="ruby-identifier">drop_foreign_key</span>([<span class="ruby-value">:name</span>]) <span class="ruby-comment"># DROP CONSTRAINT table_name_fkey</span>
</pre>
          
          

          
          <div class="method-source-code" id="drop_foreign_key-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">535</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">drop_foreign_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">536</span>   <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:foreign_key_constraint_name</span>]
<span class="line-num">537</span>     <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>]
<span class="line-num">538</span>     <span class="ruby-identifier">opts</span>[<span class="ruby-value">:name</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:foreign_key_constraint_name</span>]
<span class="line-num">539</span>   <span class="ruby-keyword">end</span>
<span class="line-num">540</span>   <span class="ruby-identifier">drop_composite_foreign_key</span>(<span class="ruby-constant">Array</span>(<span class="ruby-identifier">name</span>), <span class="ruby-identifier">opts</span>)
<span class="line-num">541</span>   <span class="ruby-identifier">drop_column</span>(<span class="ruby-identifier">name</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">542</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-drop_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">drop_index</span><span
            class="method-args">(columns, options=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Remove an index from the table. General options:</p>
<dl class="rdoc-list note-list"><dt>:name 
<dd>
<p>The name of the index to drop.  If not given, uses the same name that would be used by <a href="AlterTableGenerator.html#method-i-add_index"><code>add_index</code></a> with the same columns.</p>
</dd></dl>

<p>PostgreSQL specific options:</p>
<dl class="rdoc-list note-list"><dt>:cascade 
<dd>
<p>Cascade the index drop to dependent objects.</p>
</dd><dt>:concurrently 
<dd>
<p>Drop the index using CONCURRENTLY, which doesn&#39;t block operations on the table.  Supported in PostgreSQL 9.2+.</p>
</dd><dt>:if_exists 
<dd>
<p>Only drop the index if it already exists.</p>
</dd></dl>

<pre class="ruby"><span class="ruby-identifier">drop_index</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># DROP INDEX table_artist_id_index</span>
<span class="ruby-identifier">drop_index</span>([<span class="ruby-value">:a</span>, <span class="ruby-value">:b</span>]) <span class="ruby-comment"># DROP INDEX table_a_b_index</span>
<span class="ruby-identifier">drop_index</span>([<span class="ruby-value">:a</span>, <span class="ruby-value">:b</span>], <span class="ruby-value">name:</span> <span class="ruby-value">:foo</span>) <span class="ruby-comment"># DROP INDEX foo</span>
</pre>
          
          

          
          <div class="method-source-code" id="drop_index-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">559</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">drop_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">560</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:drop_index</span>, <span class="ruby-value">:columns</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>)}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">options</span>)
<span class="line-num">561</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">562</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rename_column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rename_column</span><span
            class="method-args">(name, new_name, opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Rename one of the table&#39;s columns.</p>

<pre class="ruby"><span class="ruby-identifier">rename_column</span>(<span class="ruby-value">:name</span>, <span class="ruby-value">:artist_name</span>) <span class="ruby-comment"># RENAME COLUMN name TO artist_name</span>
</pre>
          
          

          
          <div class="method-source-code" id="rename_column-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">567</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">rename_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">new_name</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">568</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:rename_column</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:new_name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">new_name</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">569</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">570</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_column_allow_null" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_column_allow_null</span><span
            class="method-args">(name, allow_null=true)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set a given column as allowing NULL values.</p>

<pre class="ruby"><span class="ruby-identifier">set_column_allow_null</span>(<span class="ruby-value">:artist_name</span>) <span class="ruby-comment"># ALTER COLUMN artist_name DROP NOT NULL</span>
</pre>

<p>On MySQL, make sure to use a symbol for the name of the column, as otherwise you can lose the default and type for the column.</p>
          
          

          
          <div class="method-source-code" id="set_column_allow_null-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">608</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_column_allow_null</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">allow_null</span>=<span class="ruby-keyword">true</span>)
<span class="line-num">609</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:set_column_null</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:null</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">allow_null</span>}
<span class="line-num">610</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">611</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_column_default" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_column_default</span><span
            class="method-args">(name, default)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Modify the default value for one of the table&#39;s column.</p>

<pre class="ruby"><span class="ruby-identifier">set_column_default</span>(<span class="ruby-value">:artist_name</span>, <span class="ruby-string">&#39;a&#39;</span>) <span class="ruby-comment"># ALTER COLUMN artist_name SET DEFAULT &#39;a&#39;</span>
</pre>

<p>To remove an existing default value, use <code>nil</code> as the value:</p>

<pre class="ruby"><span class="ruby-identifier">set_column_default</span>(<span class="ruby-value">:artist_name</span>, <span class="ruby-keyword">nil</span>) <span class="ruby-comment"># ALTER COLUMN artist_name SET DEFAULT NULL</span>
</pre>

<p>On MySQL, make sure to use a symbol for the name of the column, as otherwise you can lose the type and NULL/NOT NULL setting for the column.</p>
          
          

          
          <div class="method-source-code" id="set_column_default-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">582</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_column_default</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">default</span>)
<span class="line-num">583</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:set_column_default</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">default</span>}
<span class="line-num">584</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">585</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_column_not_null" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_column_not_null</span><span
            class="method-args">(name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set a given column as not allowing NULL values.</p>

<pre class="ruby"><span class="ruby-identifier">set_column_not_null</span>(<span class="ruby-value">:artist_name</span>) <span class="ruby-comment"># ALTER COLUMN artist_name SET NOT NULL</span>
</pre>

<p>On MySQL, make sure to use a symbol for the name of the column, as otherwise you can lose the default and type for the column.</p>
          
          

          
          <div class="method-source-code" id="set_column_not_null-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">619</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_column_not_null</span>(<span class="ruby-identifier">name</span>)
<span class="line-num">620</span>   <span class="ruby-identifier">set_column_allow_null</span>(<span class="ruby-identifier">name</span>, <span class="ruby-keyword">false</span>)
<span class="line-num">621</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_column_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_column_type</span><span
            class="method-args">(name, type, opts=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Modify the type of one of the table&#39;s column.</p>

<pre class="ruby"><span class="ruby-identifier">set_column_type</span>(<span class="ruby-value">:artist_name</span>, <span class="ruby-string">&#39;char(10)&#39;</span>) <span class="ruby-comment"># ALTER COLUMN artist_name TYPE char(10)</span>
</pre>

<p>PostgreSQL specific options:</p>
<dl class="rdoc-list note-list"><dt>:using 
<dd>
<p>Add a USING clause that specifies how to convert existing values to new values.</p>
</dd></dl>

<p>On MySQL, make sure to use a symbol for the name of the column, as otherwise you can lose the default and NULL/NOT NULL setting for the column.</p>
          
          

          
          <div class="method-source-code" id="set_column_type-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">597</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_column_type</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">598</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:set_column_type</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">type</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">599</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">600</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.1.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

