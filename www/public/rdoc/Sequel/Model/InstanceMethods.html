<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Sequel::Model::InstanceMethods - Sequel: The Database Toolkit for Ruby</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/navigation.js" defer></script>
<script src="../../js/search.js" defer></script>
<script src="../../js/search_index.js" defer></script>
<script src="../../js/searcher.js" defer></script>
<script src="../../js/darkfish.js" defer></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-3D-3D">#==</a>
    
    <li ><a href="#method-i-3D-3D-3D">#===</a>
    
    <li ><a href="#method-i-5B-5D">#[]</a>
    
    <li ><a href="#method-i-5B-5D-3D">#[]=</a>
    
    <li ><a href="#method-i-autoincrementing_primary_key">#autoincrementing_primary_key</a>
    
    <li ><a href="#method-i-cancel_action">#cancel_action</a>
    
    <li ><a href="#method-i-changed_columns">#changed_columns</a>
    
    <li ><a href="#method-i-delete">#delete</a>
    
    <li ><a href="#method-i-destroy">#destroy</a>
    
    <li ><a href="#method-i-each">#each</a>
    
    <li ><a href="#method-i-eql-3F">#eql?</a>
    
    <li ><a href="#method-i-errors">#errors</a>
    
    <li ><a href="#method-i-exists-3F">#exists?</a>
    
    <li class="calls-super" ><a href="#method-i-extend">#extend</a>
    
    <li class="calls-super" ><a href="#method-i-freeze">#freeze</a>
    
    <li ><a href="#method-i-hash">#hash</a>
    
    <li ><a href="#method-i-id">#id</a>
    
    <li ><a href="#method-i-inspect">#inspect</a>
    
    <li ><a href="#method-i-keys">#keys</a>
    
    <li ><a href="#method-i-lock-21">#lock!</a>
    
    <li ><a href="#method-i-marshallable-21">#marshallable!</a>
    
    <li ><a href="#method-i-modified-21">#modified!</a>
    
    <li ><a href="#method-i-modified-3F">#modified?</a>
    
    <li ><a href="#method-i-new-3F">#new?</a>
    
    <li ><a href="#method-i-pk">#pk</a>
    
    <li ><a href="#method-i-pk_equal-3F">#pk_equal?</a>
    
    <li ><a href="#method-i-pk_hash">#pk_hash</a>
    
    <li ><a href="#method-i-qualified_pk_hash">#qualified_pk_hash</a>
    
    <li ><a href="#method-i-refresh">#refresh</a>
    
    <li ><a href="#method-i-reload">#reload</a>
    
    <li ><a href="#method-i-save">#save</a>
    
    <li ><a href="#method-i-save_changes">#save_changes</a>
    
    <li ><a href="#method-i-set">#set</a>
    
    <li ><a href="#method-i-set_fields">#set_fields</a>
    
    <li ><a href="#method-i-set_server">#set_server</a>
    
    <li class="calls-super" ><a href="#method-i-singleton_method_added">#singleton_method_added</a>
    
    <li ><a href="#method-i-skip_validation_on_next_save-21">#skip_validation_on_next_save!</a>
    
    <li ><a href="#method-i-this">#this</a>
    
    <li ><a href="#method-i-update">#update</a>
    
    <li ><a href="#method-i-update_fields">#update_fields</a>
    
    <li ><a href="#method-i-valid-3F">#valid?</a>
    
    <li ><a href="#method-i-validate">#validate</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Sequel::Model::InstanceMethods">
  <h1 id="module-Sequel::Model::InstanceMethods" class="module">
    module Sequel::Model::InstanceMethods
  </h1>

  <section class="description">
    
<p><a href="../Model.html"><code>Sequel::Model</code></a> instance methods that implement basic model functionality.</p>
<ul><li>
<p>All of the model before/after/around hooks are implemented as instance methods that are called by <a href="../../Sequel.html"><code>Sequel</code></a> when the appropriate action occurs.  For example, when destroying a model object, <a href="../../Sequel.html"><code>Sequel</code></a> will call <code>around_destroy</code>, which will call <code>before_destroy</code>, do the destroy, and then call <code>after_destroy</code>.</p>
</li><li>
<p>The following instance_methods all call the class method of the same name: columns, db, primary_key, db_schema.</p>
</li><li>
<p>The following accessor methods are defined via metaprogramming: raise_on_save_failure, raise_on_typecast_failure, require_modification, strict_param_setting, typecast_empty_string_to_nil, typecast_on_assignment, and use_transactions.  The setter methods will change the setting for the instance, and the getter methods will check for an instance setting, then try the class setting if no instance setting has been set.</p>
</li></ul>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-to_hash" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">to_hash</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The hash of attribute values.  Keys are symbols with the names of the underlying database columns. The returned hash is a reference to the receiver&#39;s values hash, and modifying it will also modify the receiver&#39;s values.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Bob&#39;</span>).<span class="ruby-identifier">values</span> <span class="ruby-comment"># =&gt; {:name=&gt;&#39;Bob&#39;}</span>
<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">values</span> <span class="ruby-comment"># =&gt; {:id=&gt;1, :name=&gt;&#39;Jim&#39;, ...}</span>
</pre>
        
        </div>
      </div>
      
      <div id="attribute-i-values" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">values</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The hash of attribute values.  Keys are symbols with the names of the underlying database columns. The returned hash is a reference to the receiver&#39;s values hash, and modifying it will also modify the receiver&#39;s values.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Bob&#39;</span>).<span class="ruby-identifier">values</span> <span class="ruby-comment"># =&gt; {:name=&gt;&#39;Bob&#39;}</span>
<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">values</span> <span class="ruby-comment"># =&gt; {:id=&gt;1, :name=&gt;&#39;Jim&#39;, ...}</span>
</pre>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(values = OPTS) { |self| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates new instance and passes the given values to set. If a block is given, yield the instance to the block.</p>

<p>Arguments:</p>
<dl class="rdoc-list note-list"><dt>values 
<dd>
<p>should be a hash to pass to set. </p>
</dd></dl>

<pre class="ruby"><span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Bob&#39;</span>)

<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">a</span>.<span class="ruby-identifier">name</span> = <span class="ruby-string">&#39;Bob&#39;</span>
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1088</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">values</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">1089</span>   <span class="ruby-ivar">@values</span> = {}
<span class="line-num">1090</span>   <span class="ruby-ivar">@new</span> = <span class="ruby-keyword">true</span>
<span class="line-num">1091</span>   <span class="ruby-ivar">@modified</span> = <span class="ruby-keyword">true</span>
<span class="line-num">1092</span>   <span class="ruby-identifier">initialize_set</span>(<span class="ruby-identifier">values</span>)
<span class="line-num">1093</span>   <span class="ruby-identifier">_clear_changed_columns</span>(<span class="ruby-value">:initialize</span>)
<span class="line-num">1094</span>   <span class="ruby-keyword">yield</span> <span class="ruby-keyword">self</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">yield</span>)
<span class="line-num">1095</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-3D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">==</span><span
            class="method-args">(obj)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Alias of eql?</p>
          
          

          
          <div class="method-source-code" id="3D-3D-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1125</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">==</span>(<span class="ruby-identifier">obj</span>)
<span class="line-num">1126</span>   <span class="ruby-identifier">eql?</span>(<span class="ruby-identifier">obj</span>)
<span class="line-num">1127</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-3D-3D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">===</span><span
            class="method-args">(obj)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Case equality.  By default, checks equality of the primary key value, see pk_equal?.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">===</span> <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>] <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span> <span class="ruby-operator">===</span> <span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span> <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">set</span>(<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Bob&#39;</span>) <span class="ruby-operator">===</span> <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>] <span class="ruby-comment"># =&gt; true</span>
</pre>
          
          

          
          <div class="method-source-code" id="3D-3D-3D-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1135</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">===</span>(<span class="ruby-identifier">obj</span>)
<span class="line-num">1136</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">pkv</span> = <span class="ruby-identifier">pk</span>
<span class="line-num">1137</span>   <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span>
<span class="line-num">1138</span>     <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="line-num">1139</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
<span class="line-num">1140</span>     <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pkv</span>.<span class="ruby-identifier">any?</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:nil?</span>)
<span class="line-num">1141</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1142</span> 
<span class="line-num">1143</span>   (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">model</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">pk</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">pkv</span>)
<span class="line-num">1144</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="InstanceMethods.html#method-i-pk_equal-3F">pk_equal?</a>
        </div>
        

        
      </div>

    
      <div id="method-i-5B-5D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]</span><span
            class="method-args">(column)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns value of the column&#39;s attribute.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>][<span class="ruby-value">:id</span>] <span class="ruby-comment">#=&gt; 1</span>
</pre>
          
          

          
          <div class="method-source-code" id="5B-5D-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1100</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">[]</span>(<span class="ruby-identifier">column</span>)
<span class="line-num">1101</span>   <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">column</span>]
<span class="line-num">1102</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-5B-5D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]=</span><span
            class="method-args">(column, value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets the value for the given column.  If typecasting is enabled for this object, typecast the value based on the column&#39;s type. If this is a new record or the typecasted value isn&#39;t the same as the current value for the column, mark the column as changed.</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>
<span class="ruby-identifier">a</span>[<span class="ruby-value">:name</span>] = <span class="ruby-string">&#39;Bob&#39;</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">values</span> <span class="ruby-comment">#=&gt; {:name=&gt;&#39;Bob&#39;}</span>
</pre>
          
          

          
          <div class="method-source-code" id="5B-5D-3D-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1112</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">[]=</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">value</span>)
<span class="line-num">1113</span>   <span class="ruby-comment"># If it is new, it doesn&#39;t have a value yet, so we should</span>
<span class="line-num">1114</span>   <span class="ruby-comment"># definitely set the new value.</span>
<span class="line-num">1115</span>   <span class="ruby-comment"># If the column isn&#39;t in @values, we can&#39;t assume it is</span>
<span class="line-num">1116</span>   <span class="ruby-comment"># NULL in the database, so assume it has changed.</span>
<span class="line-num">1117</span>   <span class="ruby-identifier">v</span> = <span class="ruby-identifier">typecast_value</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">value</span>)
<span class="line-num">1118</span>   <span class="ruby-identifier">vals</span> = <span class="ruby-ivar">@values</span>
<span class="line-num">1119</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">new?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">vals</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">column</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">!=</span> (<span class="ruby-identifier">c</span> = <span class="ruby-identifier">vals</span>[<span class="ruby-identifier">column</span>]) <span class="ruby-operator">||</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">class</span>
<span class="line-num">1120</span>     <span class="ruby-identifier">change_column_value</span>(<span class="ruby-identifier">column</span>, <span class="ruby-identifier">v</span>)
<span class="line-num">1121</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1122</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-autoincrementing_primary_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">autoincrementing_primary_key</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The autoincrementing primary key for this model object. Should be overridden if you have a composite primary key with one part of it being autoincrementing.</p>
          
          

          
          <div class="method-source-code" id="autoincrementing_primary_key-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1167</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">autoincrementing_primary_key</span>
<span class="line-num">1168</span>   <span class="ruby-identifier">primary_key</span>
<span class="line-num">1169</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-cancel_action" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cancel_action</span><span
            class="method-args">(msg=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Cancel the current action.  Should be called in before hooks to halt the processing of the action.  If a <code>msg</code> argument is given and the model instance is configured to raise exceptions on failure, sets the message to use for the raised <a href="../HookFailed.html"><code>HookFailed</code></a> exception.</p>
          
          

          
          <div class="method-source-code" id="cancel_action-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1175</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">cancel_action</span>(<span class="ruby-identifier">msg</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">1176</span>   <span class="ruby-identifier">raise_hook_failure</span>(<span class="ruby-identifier">msg</span>)
<span class="line-num">1177</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-changed_columns" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">changed_columns</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The columns that have been updated.  This isn&#39;t completely accurate, as it could contain columns whose values have not changed.</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">changed_columns</span> <span class="ruby-comment"># =&gt; []</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">name</span> = <span class="ruby-string">&#39;Bob&#39;</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">changed_columns</span> <span class="ruby-comment"># =&gt; [:name]</span>
</pre>
          
          

          
          <div class="method-source-code" id="changed_columns-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1186</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">changed_columns</span>
<span class="line-num">1187</span>   <span class="ruby-identifier">_changed_columns</span>
<span class="line-num">1188</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Deletes and returns <code>self</code>.  Does not run destroy hooks. Look into using <code>destroy</code> instead.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">delete</span> <span class="ruby-comment"># DELETE FROM artists WHERE (id = 1)</span>
<span class="ruby-comment"># =&gt; #&lt;Artist {:id=&gt;1, ...}&gt;</span>
</pre>
          
          

          
          <div class="method-source-code" id="delete-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1195</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">delete</span>
<span class="line-num">1196</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;can&#39;t delete frozen object&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">frozen?</span>
<span class="line-num">1197</span>   <span class="ruby-identifier">_delete</span>
<span class="line-num">1198</span>   <span class="ruby-keyword">self</span>
<span class="line-num">1199</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">destroy</span><span
            class="method-args">(opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Like delete but runs hooks before and after delete. Uses a transaction if use_transactions is true or if the :transaction option is given and true.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">destroy</span> <span class="ruby-comment"># BEGIN; DELETE FROM artists WHERE (id = 1); COMMIT;</span>
<span class="ruby-comment"># =&gt; #&lt;Artist {:id=&gt;1, ...}&gt;</span>
</pre>
          
          

          
          <div class="method-source-code" id="destroy-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1207</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">destroy</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">1208</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;can&#39;t destroy frozen object&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">frozen?</span>
<span class="line-num">1209</span>   <span class="ruby-identifier">checked_save_failure</span>(<span class="ruby-identifier">opts</span>){<span class="ruby-identifier">checked_transaction</span>(<span class="ruby-identifier">opts</span>){<span class="ruby-identifier">_destroy</span>(<span class="ruby-identifier">opts</span>)}}
<span class="line-num">1210</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each</span><span
            class="method-args">(&amp;block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Iterates through all of the current values using each.</p>

<pre class="ruby"><span class="ruby-constant">Album</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{k} =&gt; #{v}&quot;</span>}
<span class="ruby-comment"># id =&gt; 1</span>
<span class="ruby-comment"># name =&gt; &#39;Bob&#39;</span>
</pre>
          
          

          
          <div class="method-source-code" id="each-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1217</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">1218</span>   <span class="ruby-ivar">@values</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">1219</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-eql-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">eql?</span><span
            class="method-args">(obj)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Compares model instances by values.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>] <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span> <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">set</span>(<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Bob&#39;</span>) <span class="ruby-operator">==</span> <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>] <span class="ruby-comment"># =&gt; false</span>
</pre>
          
          

          
          <div class="method-source-code" id="eql-3F-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1226</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">eql?</span>(<span class="ruby-identifier">obj</span>)
<span class="line-num">1227</span>   (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">model</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">values</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@values</span>)
<span class="line-num">1228</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-errors" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">errors</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the validation errors associated with this object. See <code>Errors</code>.</p>
          
          

          
          <div class="method-source-code" id="errors-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1232</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">errors</span>
<span class="line-num">1233</span>   <span class="ruby-ivar">@errors</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">errors_class</span>.<span class="ruby-identifier">new</span>
<span class="line-num">1234</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">exists?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true when current instance exists, false otherwise. Generally an object that isn&#39;t new will exist unless it has been deleted.  Uses a database query to check for existence, unless the model object is new, in which case this is always false.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">exists?</span> <span class="ruby-comment"># SELECT 1 FROM artists WHERE (id = 1)</span>
<span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">exists?</span>
<span class="ruby-comment"># =&gt; false</span>
</pre>
          
          

          
          <div class="method-source-code" id="exists-3F-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1246</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">exists?</span>
<span class="line-num">1247</span>   <span class="ruby-identifier">new?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">:</span> <span class="ruby-operator">!</span><span class="ruby-identifier">this</span>.<span class="ruby-identifier">get</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">AliasedExpression</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">1</span>, <span class="ruby-value">:one</span>)).<span class="ruby-identifier">nil?</span>
<span class="line-num">1248</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-extend" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">extend</span><span
            class="method-args">(mod)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Ignore the model&#39;s setter method cache when this instances extends a module, as the module may contain setter methods.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="extend-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1252</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extend</span>(<span class="ruby-identifier">mod</span>)
<span class="line-num">1253</span>   <span class="ruby-ivar">@singleton_setter_added</span> = <span class="ruby-keyword">true</span>
<span class="line-num">1254</span>   <span class="ruby-keyword">super</span>
<span class="line-num">1255</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-freeze" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">freeze</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Freeze the object in such a way that it is still usable but not modifiable. Once an object is frozen, you cannot modify it&#39;s values, <a href="InstanceMethods.html#method-i-changed_columns"><code>changed_columns</code></a>, errors, or dataset.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="freeze-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1260</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">freeze</span>
<span class="line-num">1261</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">frozen?</span>
<span class="line-num">1262</span>     <span class="ruby-identifier">validate</span>
<span class="line-num">1263</span>     <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">freeze</span>
<span class="line-num">1264</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1265</span>   <span class="ruby-identifier">values</span>.<span class="ruby-identifier">freeze</span>
<span class="line-num">1266</span>   <span class="ruby-identifier">_changed_columns</span>.<span class="ruby-identifier">freeze</span>
<span class="line-num">1267</span>   <span class="ruby-identifier">this</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">primary_key</span>
<span class="line-num">1268</span>   <span class="ruby-keyword">super</span>
<span class="line-num">1269</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">hash</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Value that should be unique for objects with the same class and pk (if pk is not nil), or the same class and values (if pk is nil).</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">hash</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">hash</span> <span class="ruby-comment"># true</span>
<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">set</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Bob&#39;</span>).<span class="ruby-identifier">hash</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">hash</span> <span class="ruby-comment"># true</span>
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">hash</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">hash</span> <span class="ruby-comment"># true</span>
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Bob&#39;</span>).<span class="ruby-identifier">hash</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">hash</span> <span class="ruby-comment"># false</span>
</pre>
          
          

          
          <div class="method-source-code" id="hash-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1278</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">hash</span>
<span class="line-num">1279</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">primary_key</span>
<span class="line-num">1280</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
<span class="line-num">1281</span>     [<span class="ruby-identifier">model</span>, <span class="ruby-operator">!</span><span class="ruby-identifier">pk</span>.<span class="ruby-identifier">all?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@values</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">pk</span>].<span class="ruby-identifier">hash</span>
<span class="line-num">1282</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>
<span class="line-num">1283</span>     [<span class="ruby-identifier">model</span>, <span class="ruby-identifier">pk</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@values</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">pk</span>].<span class="ruby-identifier">hash</span>
<span class="line-num">1284</span>   <span class="ruby-keyword">else</span>
<span class="line-num">1285</span>     [<span class="ruby-identifier">model</span>, <span class="ruby-ivar">@values</span>].<span class="ruby-identifier">hash</span>
<span class="line-num">1286</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1287</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-id" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">id</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns value for the :id attribute, even if the primary key is not id. To get the primary key value, use <code>pk</code>.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">id</span> <span class="ruby-comment"># =&gt; 1</span>
</pre>
          
          

          
          <div class="method-source-code" id="id-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1293</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">id</span>
<span class="line-num">1294</span>   <span class="ruby-ivar">@values</span>[<span class="ruby-value">:id</span>]
<span class="line-num">1295</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-inspect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inspect</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a string representation of the model instance including the class name and values.</p>
          
          

          
          <div class="method-source-code" id="inspect-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1299</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inspect</span>
<span class="line-num">1300</span>   <span class="ruby-node">&quot;#&lt;#{model.name} @values=#{inspect_values}&gt;&quot;</span>
<span class="line-num">1301</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">keys</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the keys in <code>values</code>.  May not include all column names.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">keys</span> <span class="ruby-comment"># =&gt; []</span>
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Bob&#39;</span>).<span class="ruby-identifier">keys</span> <span class="ruby-comment"># =&gt; [:name]</span>
<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">keys</span> <span class="ruby-comment"># =&gt; [:id, :name]</span>
</pre>
          
          

          
          <div class="method-source-code" id="keys-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1308</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">keys</span>
<span class="line-num">1309</span>   <span class="ruby-ivar">@values</span>.<span class="ruby-identifier">keys</span>
<span class="line-num">1310</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-lock-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">lock!</span><span
            class="method-args">(style=:update)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Refresh this record using <code>for_update</code> (by default, or the specified style when given) unless this is a new record.  Returns self. This can be used to make sure no other process is updating the record at the same time.</p>

<p>If style is a string, it will be used directly. You should never pass a string to this method that is derived from user input, as that can lead to <a href="../SQL.html"><code>SQL</code></a> injection.</p>

<p>A symbol may be used for database independent locking behavior, but all supported symbols have separate methods (e.g. for_update).</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">db</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">a</span>.<span class="ruby-identifier">lock!</span>
  <span class="ruby-identifier">a</span>.<span class="ruby-identifier">update</span>(<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;A&#39;</span>)
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>[<span class="ruby-value">2</span>]
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">db</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">a</span>.<span class="ruby-identifier">lock!</span>(<span class="ruby-string">&#39;FOR NO KEY UPDATE&#39;</span>)
  <span class="ruby-identifier">a</span>.<span class="ruby-identifier">update</span>(<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;B&#39;</span>)
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="lock-21-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1335</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">lock!</span>(<span class="ruby-identifier">style</span>=<span class="ruby-value">:update</span>)
<span class="line-num">1336</span>   <span class="ruby-identifier">_refresh</span>(<span class="ruby-identifier">this</span>.<span class="ruby-identifier">lock_style</span>(<span class="ruby-identifier">style</span>)) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">new?</span>
<span class="line-num">1337</span>   <span class="ruby-keyword">self</span>
<span class="line-num">1338</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-marshallable-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">marshallable!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Remove elements of the model object that make marshalling fail. Returns self.</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">marshallable!</span>
<span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">a</span>)
</pre>
          
          

          
          <div class="method-source-code" id="marshallable-21-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1345</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">marshallable!</span>
<span class="line-num">1346</span>   <span class="ruby-ivar">@this</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">1347</span>   <span class="ruby-keyword">self</span>
<span class="line-num">1348</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-modified-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">modified!</span><span
            class="method-args">(column=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Explicitly mark the object as modified, so <code>save_changes</code>/<code>update</code> will run callbacks even if no columns have changed.</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">save_changes</span> <span class="ruby-comment"># No callbacks run, as no changes</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">modified!</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">save_changes</span> <span class="ruby-comment"># Callbacks run, even though no changes made</span>
</pre>

<p>If a column is given, specifically marked that column as modified, so that <code>save_changes</code>/<code>update</code> will include that column in the update. This should be used if you plan on mutating the column value instead of assigning a new column value:</p>

<pre class="ruby"><span class="ruby-identifier">a</span>.<span class="ruby-identifier">modified!</span>(<span class="ruby-value">:name</span>)
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/[aeou]/</span>, <span class="ruby-string">&#39;i&#39;</span>)
</pre>
          
          

          
          <div class="method-source-code" id="modified-21-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1365</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">modified!</span>(<span class="ruby-identifier">column</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">1366</span>   <span class="ruby-identifier">_add_changed_column</span>(<span class="ruby-identifier">column</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span>
<span class="line-num">1367</span>   <span class="ruby-ivar">@modified</span> = <span class="ruby-keyword">true</span>
<span class="line-num">1368</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-modified-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">modified?</span><span
            class="method-args">(column=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Whether this object has been modified since last saved, used by <a href="InstanceMethods.html#method-i-save_changes"><code>save_changes</code></a> to determine whether changes should be saved.  New values are always considered modified.</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">modified?</span> <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">set</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Jim&#39;</span>)
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">modified?</span> <span class="ruby-comment"># =&gt; true</span>
</pre>

<p>If a column is given, specifically check if the given column has been modified:</p>

<pre class="ruby"><span class="ruby-identifier">a</span>.<span class="ruby-identifier">modified?</span>(<span class="ruby-value">:num_albums</span>) <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">num_albums</span> = <span class="ruby-value">10</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">modified?</span>(<span class="ruby-value">:num_albums</span>) <span class="ruby-comment"># =&gt; true</span>
</pre>
          
          

          
          <div class="method-source-code" id="modified-3F-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1385</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">modified?</span>(<span class="ruby-identifier">column</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">1386</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span>
<span class="line-num">1387</span>     <span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">column</span>)
<span class="line-num">1388</span>   <span class="ruby-keyword">else</span>
<span class="line-num">1389</span>     <span class="ruby-ivar">@modified</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">changed_columns</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">1390</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1391</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-new-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if the current instance represents a new record.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">new?</span> <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">new?</span> <span class="ruby-comment"># =&gt; false</span>
</pre>
          
          

          
          <div class="method-source-code" id="new-3F-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1397</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">new?</span>
<span class="line-num">1398</span>   <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@new</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@new</span> <span class="ruby-operator">:</span> (<span class="ruby-ivar">@new</span> = <span class="ruby-keyword">false</span>)
<span class="line-num">1399</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-pk" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pk</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the primary key value identifying the model instance. Raises an <code>Error</code> if this model does not have a primary key. If the model has a composite primary key, returns an array of values.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">pk</span> <span class="ruby-comment"># =&gt; 1</span>
<span class="ruby-constant">Artist</span>[[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>]].<span class="ruby-identifier">pk</span> <span class="ruby-comment"># =&gt; [1, 2]</span>
</pre>
          
          

          
          <div class="method-source-code" id="pk-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1407</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pk</span>
<span class="line-num">1408</span>   <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;No primary key is associated with this model&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">key</span> = <span class="ruby-identifier">primary_key</span>
<span class="line-num">1409</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">1410</span>     <span class="ruby-identifier">vals</span> = <span class="ruby-ivar">@values</span>
<span class="line-num">1411</span>     <span class="ruby-identifier">key</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">vals</span>[<span class="ruby-identifier">k</span>]}
<span class="line-num">1412</span>   <span class="ruby-keyword">else</span>
<span class="line-num">1413</span>     <span class="ruby-ivar">@values</span>[<span class="ruby-identifier">key</span>]
<span class="line-num">1414</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1415</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-pk_equal-3F" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">pk_equal?</span><span
            class="method-args">(obj)</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If the receiver has a primary key value, returns true if the objects have the same class and primary key value. If the receiver&#39;s primary key value is nil or is an array containing nil, returns false.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">pk_equal?</span>(<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]) <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">pk_equal?</span>(<span class="ruby-constant">Artist</span>.<span class="ruby-identifier">new</span>) <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">set</span>(<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&#39;Bob&#39;</span>).<span class="ruby-identifier">pk_equal?</span>(<span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]) <span class="ruby-comment"># =&gt; true</span>
</pre>
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="InstanceMethods.html#method-i-3D-3D-3D">===</a>
        </div>
        
      </div>

    
      <div id="method-i-pk_hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pk_hash</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a hash mapping the receivers primary key column(s) to their values.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">pk_hash</span> <span class="ruby-comment"># =&gt; {:id=&gt;1}</span>
<span class="ruby-constant">Artist</span>[[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>]].<span class="ruby-identifier">pk_hash</span> <span class="ruby-comment"># =&gt; {:id1=&gt;1, :id2=&gt;2}</span>
</pre>
          
          

          
          <div class="method-source-code" id="pk_hash-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1421</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pk_hash</span>
<span class="line-num">1422</span>   <span class="ruby-identifier">model</span>.<span class="ruby-identifier">primary_key_hash</span>(<span class="ruby-identifier">pk</span>)
<span class="line-num">1423</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-qualified_pk_hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">qualified_pk_hash</span><span
            class="method-args">(qualifier=model.table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a hash mapping the receivers qualified primary key column(s) to their values.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">qualified_pk_hash</span>
<span class="ruby-comment"># =&gt; {Sequel[:artists][:id]=&gt;1}</span>
<span class="ruby-constant">Artist</span>[[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>]].<span class="ruby-identifier">qualified_pk_hash</span>
<span class="ruby-comment"># =&gt; {Sequel[:artists][:id1]=&gt;1, Sequel[:artists][:id2]=&gt;2}</span>
</pre>
          
          

          
          <div class="method-source-code" id="qualified_pk_hash-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1431</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">qualified_pk_hash</span>(<span class="ruby-identifier">qualifier</span>=<span class="ruby-identifier">model</span>.<span class="ruby-identifier">table_name</span>)
<span class="line-num">1432</span>   <span class="ruby-identifier">model</span>.<span class="ruby-identifier">qualified_primary_key_hash</span>(<span class="ruby-identifier">pk</span>, <span class="ruby-identifier">qualifier</span>)
<span class="line-num">1433</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-refresh" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">refresh</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Reloads attributes from database and returns self. Also clears all <a href="InstanceMethods.html#method-i-changed_columns"><code>changed_columns</code></a> information.  Raises an <code>Error</code> if the record no longer exists in the database.</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">name</span> = <span class="ruby-string">&#39;Jim&#39;</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">refresh</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &#39;Bob&#39;</span>
</pre>
          
          

          
          <div class="method-source-code" id="refresh-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1443</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">refresh</span>
<span class="line-num">1444</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;can&#39;t refresh frozen object&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">frozen?</span>
<span class="line-num">1445</span>   <span class="ruby-identifier">_refresh</span>(<span class="ruby-identifier">this</span>)
<span class="line-num">1446</span>   <span class="ruby-keyword">self</span>
<span class="line-num">1447</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reload" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reload</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Alias of refresh, but not aliased directly to make overriding in a plugin easier.</p>
          
          

          
          <div class="method-source-code" id="reload-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1450</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reload</span>
<span class="line-num">1451</span>   <span class="ruby-identifier">refresh</span>
<span class="line-num">1452</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save</span><span
            class="method-args">(opts=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates or updates the record, after making sure the record is valid and before hooks execute successfully. Fails if:</p>
<ul><li>
<p>the record is not valid, or</p>
</li><li>
<p>before_save calls <a href="InstanceMethods.html#method-i-cancel_action"><code>cancel_action</code></a>, or</p>
</li><li>
<p>the record is new and before_create calls <a href="InstanceMethods.html#method-i-cancel_action"><code>cancel_action</code></a>, or</p>
</li><li>
<p>the record is not new and before_update calls cancel_action.</p>
</li></ul>

<p>If <code>save</code> fails and either raise_on_save_failure or the :raise_on_failure option is true, it raises <a href="../ValidationFailed.html"><code>ValidationFailed</code></a> or <a href="../HookFailed.html"><code>HookFailed</code></a>. Otherwise it returns nil.</p>

<p>If it succeeds, it returns self.</p>

<p>Takes the following options:</p>
<dl class="rdoc-list note-list"><dt>:changed 
<dd>
<p>save all changed columns, instead of all columns or the columns given</p>
</dd><dt>:columns 
<dd>
<p>array of specific columns that should be saved.</p>
</dd><dt>:raise_on_failure 
<dd>
<p>set to true or false to override the current <code>raise_on_save_failure</code> setting</p>
</dd><dt>:server 
<dd>
<p>set the server/shard on the object before saving, and use that server/shard in any transaction.</p>
</dd><dt>:transaction 
<dd>
<p>set to true or false to override the current <code>use_transactions</code> setting</p>
</dd><dt>:validate 
<dd>
<p>set to false to skip validation</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="save-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1479</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">save</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">1480</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-string">&quot;can&#39;t save frozen object&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">frozen?</span>
<span class="line-num">1481</span>   <span class="ruby-identifier">set_server</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:server</span>] 
<span class="line-num">1482</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">_save_valid?</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">1483</span>     <span class="ruby-identifier">raise</span>(<span class="ruby-identifier">validation_failed_error</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">raise_on_failure?</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">1484</span>     <span class="ruby-keyword">return</span>
<span class="line-num">1485</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1486</span>   <span class="ruby-identifier">checked_save_failure</span>(<span class="ruby-identifier">opts</span>){<span class="ruby-identifier">checked_transaction</span>(<span class="ruby-identifier">opts</span>){<span class="ruby-identifier">_save</span>(<span class="ruby-identifier">opts</span>)}}
<span class="line-num">1487</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_changes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_changes</span><span
            class="method-args">(opts=OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Saves only changed columns if the object has been modified. If the object has not been modified, returns nil.  If unable to save, returns false unless <code>raise_on_save_failure</code> is true.</p>

<pre class="ruby"><span class="ruby-identifier">a</span> = <span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>]
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">save_changes</span> <span class="ruby-comment"># =&gt; nil</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">name</span> = <span class="ruby-string">&#39;Jim&#39;</span>
<span class="ruby-identifier">a</span>.<span class="ruby-identifier">save_changes</span> <span class="ruby-comment"># UPDATE artists SET name = &#39;Bob&#39; WHERE (id = 1)</span>
<span class="ruby-comment"># =&gt; #&lt;Artist {:id=&gt;1, :name=&gt;&#39;Jim&#39;, ...}</span>
</pre>
          
          

          
          <div class="method-source-code" id="save_changes-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1498</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">save_changes</span>(<span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">1499</span>   <span class="ruby-identifier">save</span>(<span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:changed</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>)) <span class="ruby-operator">||</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">modified?</span> 
<span class="line-num">1500</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set</span><span
            class="method-args">(hash)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Updates the instance with the supplied values with support for virtual attributes, raising an exception if a value is used that doesn&#39;t have a setter method (or ignoring it if <code>strict_param_setting = false</code>). Does not save the record.</p>

<pre class="ruby"><span class="ruby-identifier">artist</span>.<span class="ruby-identifier">set</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Jim&#39;</span>)
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &#39;Jim&#39;</span>
</pre>
          
          

          
          <div class="method-source-code" id="set-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1509</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">1510</span>   <span class="ruby-identifier">set_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-value">:default</span>)
<span class="line-num">1511</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_fields" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_fields</span><span
            class="method-args">(hash, fields, opts=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>For each of the fields in the given array <code>fields</code>, call the setter method with the value of that <code>hash</code> entry for the field. Returns self.</p>

<p>You can provide an options hash, with the following options currently respected:</p>
<dl class="rdoc-list note-list"><dt>:missing 
<dd>
<p>Can be set to :skip to skip missing entries or :raise to raise an <a href="../Error.html"><code>Error</code></a> for missing entries.  The default behavior is not to check for missing entries, in which case the default value is used.  To be friendly with most web frameworks, the missing check will also check for the string version of the argument in the hash if given a symbol.</p>
</dd></dl>

<p>Examples:</p>

<pre class="ruby"><span class="ruby-identifier">artist</span>.<span class="ruby-identifier">set_fields</span>({<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Jim&#39;</span>}, [<span class="ruby-value">:name</span>])
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &#39;Jim&#39;</span>

<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">set_fields</span>({<span class="ruby-value">hometown:</span> <span class="ruby-string">&#39;LA&#39;</span>}, [<span class="ruby-value">:name</span>])
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; nil</span>
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">hometown</span> <span class="ruby-comment"># =&gt; &#39;Sac&#39;</span>

<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &#39;Jim&#39;</span>
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">set_fields</span>({}, [<span class="ruby-value">:name</span>], <span class="ruby-value">missing:</span> <span class="ruby-value">:skip</span>)
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &#39;Jim&#39;</span>

<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; &#39;Jim&#39;</span>
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">set_fields</span>({}, [<span class="ruby-value">:name</span>], <span class="ruby-value">missing:</span> <span class="ruby-value">:raise</span>)
<span class="ruby-comment"># Sequel::Error raised</span>
</pre>
          
          

          
          <div class="method-source-code" id="set_fields-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1539</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_fields</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">fields</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">1540</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>
<span class="line-num">1541</span>     <span class="ruby-identifier">model</span>.<span class="ruby-identifier">default_set_fields_options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">1542</span>   <span class="ruby-keyword">else</span>
<span class="line-num">1543</span>     <span class="ruby-identifier">model</span>.<span class="ruby-identifier">default_set_fields_options</span>
<span class="line-num">1544</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1545</span> 
<span class="line-num">1546</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">missing</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:missing</span>]
<span class="line-num">1547</span>   <span class="ruby-keyword">when</span> <span class="ruby-value">:skip</span>, <span class="ruby-value">:raise</span>
<span class="line-num">1548</span>     <span class="ruby-identifier">do_raise</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">missing</span> <span class="ruby-operator">==</span> <span class="ruby-value">:raise</span>
<span class="line-num">1549</span>     <span class="ruby-identifier">fields</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
<span class="line-num">1550</span>       <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">f</span>) 
<span class="line-num">1551</span>         <span class="ruby-identifier">set_column_value</span>(<span class="ruby-node">&quot;#{f}=&quot;</span>, <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">f</span>])
<span class="line-num">1552</span>       <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">sf</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">to_s</span>)
<span class="line-num">1553</span>         <span class="ruby-identifier">set_column_value</span>(<span class="ruby-node">&quot;#{sf}=&quot;</span>, <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">sf</span>])
<span class="line-num">1554</span>       <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">do_raise</span>
<span class="line-num">1555</span>         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;missing field in hash: #{f.inspect} not in #{hash.inspect}&quot;</span>)
<span class="line-num">1556</span>       <span class="ruby-keyword">end</span>
<span class="line-num">1557</span>     <span class="ruby-keyword">end</span>
<span class="line-num">1558</span>   <span class="ruby-keyword">else</span>
<span class="line-num">1559</span>     <span class="ruby-identifier">fields</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">set_column_value</span>(<span class="ruby-node">&quot;#{f}=&quot;</span>, <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">f</span>])}
<span class="line-num">1560</span>   <span class="ruby-keyword">end</span>
<span class="line-num">1561</span>   <span class="ruby-keyword">self</span>
<span class="line-num">1562</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_server" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_server</span><span
            class="method-args">(s)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set the shard that this object is tied to.  Returns self.</p>
          
          

          
          <div class="method-source-code" id="set_server-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1565</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_server</span>(<span class="ruby-identifier">s</span>)
<span class="line-num">1566</span>   <span class="ruby-ivar">@server</span> = <span class="ruby-identifier">s</span>
<span class="line-num">1567</span>   <span class="ruby-ivar">@this</span> = <span class="ruby-ivar">@this</span>.<span class="ruby-identifier">server</span>(<span class="ruby-identifier">s</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@this</span>
<span class="line-num">1568</span>   <span class="ruby-keyword">self</span>
<span class="line-num">1569</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-singleton_method_added" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">singleton_method_added</span><span
            class="method-args">(meth)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clear the setter_methods cache when a method is added</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="singleton_method_added-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1572</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">singleton_method_added</span>(<span class="ruby-identifier">meth</span>)
<span class="line-num">1573</span>   <span class="ruby-ivar">@singleton_setter_added</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">meth</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">end_with?</span>(<span class="ruby-string">&#39;=&#39;</span>)
<span class="line-num">1574</span>   <span class="ruby-keyword">super</span>
<span class="line-num">1575</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-skip_validation_on_next_save-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">skip_validation_on_next_save!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Skip all validation of the object on the next call to <a href="InstanceMethods.html#method-i-save"><code>save</code></a>, including the running of validation hooks. This is designed for and should only be used in cases where <a href="InstanceMethods.html#method-i-valid-3F"><code>valid?</code></a> is called before saving and the <code>validate: false</code> option cannot be passed to <a href="InstanceMethods.html#method-i-save"><code>save</code></a>.</p>
          
          

          
          <div class="method-source-code" id="skip_validation_on_next_save-21-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1582</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_validation_on_next_save!</span>
<span class="line-num">1583</span>   <span class="ruby-ivar">@skip_validation_on_next_save</span> = <span class="ruby-keyword">true</span>
<span class="line-num">1584</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-this" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">this</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns (naked) dataset that should return only this instance.</p>

<pre class="ruby"><span class="ruby-constant">Artist</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">this</span>
<span class="ruby-comment"># SELECT * FROM artists WHERE (id = 1) LIMIT 1</span>
</pre>
          
          

          
          <div class="method-source-code" id="this-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1590</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">this</span>
<span class="line-num">1591</span>   <span class="ruby-keyword">return</span> <span class="ruby-ivar">@this</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@this</span>
<span class="line-num">1592</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;No dataset for model #{model}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">instance_dataset</span>
<span class="line-num">1593</span>   <span class="ruby-ivar">@this</span> = <span class="ruby-identifier">use_server</span>(<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">pk_hash</span>))
<span class="line-num">1594</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-update" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update</span><span
            class="method-args">(hash)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Runs <a href="InstanceMethods.html#method-i-set"><code>set</code></a> with the passed hash and then runs save_changes.</p>

<pre class="ruby"><span class="ruby-identifier">artist</span>.<span class="ruby-identifier">update</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Jim&#39;</span>) <span class="ruby-comment"># UPDATE artists SET name = &#39;Jim&#39; WHERE (id = 1)</span>
</pre>
          
          

          
          <div class="method-source-code" id="update-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1599</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">1600</span>   <span class="ruby-identifier">update_restricted</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-value">:default</span>)
<span class="line-num">1601</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-update_fields" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update_fields</span><span
            class="method-args">(hash, fields, opts=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Update the instance&#39;s values by calling <a href="InstanceMethods.html#method-i-set_fields"><code>set_fields</code></a> with the arguments, then calls save_changes.</p>

<pre class="ruby"><span class="ruby-identifier">artist</span>.<span class="ruby-identifier">update_fields</span>({<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Jim&#39;</span>}, [<span class="ruby-value">:name</span>])
<span class="ruby-comment"># UPDATE artists SET name = &#39;Jim&#39; WHERE (id = 1)</span>

<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">update_fields</span>({<span class="ruby-value">hometown:</span> <span class="ruby-string">&#39;LA&#39;</span>}, [<span class="ruby-value">:name</span>])
<span class="ruby-comment"># UPDATE artists SET name = NULL WHERE (id = 1)</span>
</pre>
          
          

          
          <div class="method-source-code" id="update_fields-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1611</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_fields</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">fields</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">1612</span>   <span class="ruby-identifier">set_fields</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">fields</span>, <span class="ruby-identifier">opts</span>)
<span class="line-num">1613</span>   <span class="ruby-identifier">save_changes</span>
<span class="line-num">1614</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-valid-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">valid?</span><span
            class="method-args">(opts = OPTS)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Validates the object and returns true if no errors are reported.</p>

<pre class="ruby"><span class="ruby-identifier">artist</span>.<span class="ruby-identifier">set</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Valid&#39;</span>).<span class="ruby-identifier">valid?</span> <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">set</span>(<span class="ruby-value">name:</span> <span class="ruby-string">&#39;Invalid&#39;</span>).<span class="ruby-identifier">valid?</span> <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">artist</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">full_messages</span> <span class="ruby-comment"># =&gt; [&#39;name cannot be Invalid&#39;]</span>
</pre>
          
          

          
          <div class="method-source-code" id="valid-3F-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1630</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">valid?</span>(<span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">1631</span>   <span class="ruby-identifier">_valid?</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">1632</span> <span class="ruby-keyword">rescue</span> <span class="ruby-constant">HookFailed</span>
<span class="line-num">1633</span>   <span class="ruby-keyword">false</span>
<span class="line-num">1634</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-validate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validate</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Validates the object.  If the object is invalid, errors should be added to the errors attribute.  By default, does nothing, as all models are valid by default.  See the <a href="../../doc/validations_rdoc.html">“Model Validations” guide</a>. for details about validation.  Should not be called directly by user code, call <code>valid?</code> instead to check if an object is valid.</p>
          
          

          
          <div class="method-source-code" id="validate-source">
            <pre>     <span class="ruby-comment"># File lib/sequel/model/base.rb</span>
<span class="line-num">1622</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validate</span>
<span class="line-num">1623</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.1.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

