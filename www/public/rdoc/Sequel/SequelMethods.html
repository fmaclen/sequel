<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module Sequel::Timezones - Sequel: The Database Toolkit for Ruby</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/navigation.js" defer></script>
<script src="../js/search.js" defer></script>
<script src="../js/search_index.js" defer></script>
<script src="../js/searcher.js" defer></script>
<script src="../js/darkfish.js" defer></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">




<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-application_to_database_timestamp">#application_to_database_timestamp</a>
    
    <li ><a href="#method-i-condition_specifier-3F">#condition_specifier?</a>
    
    <li ><a href="#method-i-connect">#connect</a>
    
    <li ><a href="#method-i-convert_exception_class">#convert_exception_class</a>
    
    <li ><a href="#method-i-convert_output_timestamp">#convert_output_timestamp</a>
    
    <li ><a href="#method-i-convert_timestamp">#convert_timestamp</a>
    
    <li ><a href="#method-i-core_extensions-3F">#core_extensions?</a>
    
    <li ><a href="#method-i-current">#current</a>
    
    <li ><a href="#method-i-database_to_application_timestamp">#database_to_application_timestamp</a>
    
    <li ><a href="#method-i-default_timezone-3D">#default_timezone=</a>
    
    <li ><a href="#method-i-elapsed_seconds_since">#elapsed_seconds_since</a>
    
    <li ><a href="#method-i-extension">#extension</a>
    
    <li ><a href="#method-i-json_parser_error_class">#json_parser_error_class</a>
    
    <li ><a href="#method-i-object_to_json">#object_to_json</a>
    
    <li ><a href="#method-i-orig_require">#orig_require</a>
    
    <li ><a href="#method-i-parse_json">#parse_json</a>
    
    <li ><a href="#method-i-recursive_map">#recursive_map</a>
    
    <li ><a href="#method-i-require">#require</a>
    
    <li ><a href="#method-i-split_symbol">#split_symbol</a>
    
    <li ><a href="#method-i-split_symbols-3D">#split_symbols=</a>
    
    <li ><a href="#method-i-split_symbols-3F">#split_symbols?</a>
    
    <li ><a href="#method-i-start_timer">#start_timer</a>
    
    <li ><a href="#method-i-string_to_date">#string_to_date</a>
    
    <li ><a href="#method-i-string_to_datetime">#string_to_datetime</a>
    
    <li ><a href="#method-i-string_to_time">#string_to_time</a>
    
    <li ><a href="#method-i-synchronize">#synchronize</a>
    
    <li ><a href="#method-i-synchronize_with">#synchronize_with</a>
    
    <li ><a href="#method-i-transaction">#transaction</a>
    
    <li ><a href="#method-i-typecast_to_application_timestamp">#typecast_to_application_timestamp</a>
    
    <li ><a href="#method-i-virtual_row">#virtual_row</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-Sequel::Timezones">
  <h1 id="module-Sequel::Timezones" class="module">
    module Sequel::Timezones
  </h1>

  <section class="description">
    
<p><a href="../Sequel.html"><code>Sequel</code></a> doesn&#39;t pay much attention to timezones by default, but you can set it to handle timezones if you want.  There are three separate timezone settings:</p>
<ul><li>
<p><a href="SequelMethods.html#attribute-i-application_timezone"><code>application_timezone</code></a></p>
</li><li>
<p><a href="SequelMethods.html#attribute-i-database_timezone"><code>database_timezone</code></a></p>
</li><li>
<p><a href="SequelMethods.html#attribute-i-typecast_timezone"><code>typecast_timezone</code></a></p>
</li></ul>

<p>All three timezones have getter and setter methods. You can set all three timezones to the same value at once via <code>Sequel.default_timezone=</code>.</p>

<p>The only timezone values that are supported by default are <code>:utc</code> (convert to UTC), <code>:local</code> (convert to local time), and <code>nil</code> (don&#39;t convert).  If you need to convert to a specific timezone, or need the timezones being used to change based on the environment (e.g. current user), you need to use the <code>named_timezones</code> extension (and use <code>DateTime</code> as the <code>datetime_class</code>). <a href="../Sequel.html"><code>Sequel</code></a> also ships with a <code>thread_local_timezones</code> extensions which allows each thread to have its own timezone values for each of the timezones.</p>

  </section>

  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-application_timezone" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">application_timezone</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The timezone you want the application to use.  This is the timezone that incoming times from the database and typecasting are converted to.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-convert_two_digit_years" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">convert_two_digit_years</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><a href="../Sequel.html"><code>Sequel</code></a> converts two digit years in <code>Date</code>s and <code>DateTime</code>s by default, so 01/02/03 is interpreted at January 2nd, 2003, and 12/13/99 is interpreted as December 13, 1999. You can override this to treat those dates as January 2nd, 0003 and December 13, 0099, respectively, by:</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">convert_two_digit_years</span> = <span class="ruby-keyword">false</span>
</pre>
        
        </div>
      </div>
      
      <div id="attribute-i-database_timezone" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">database_timezone</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The timezone for storage in the database.  This is the timezone to which <a href="../Sequel.html"><code>Sequel</code></a> will convert timestamps before literalizing them for storage in the database.  It is also the timezone that <a href="../Sequel.html"><code>Sequel</code></a> will assume database timestamp values are already in (if they don&#39;t include an offset).</p>
        
        </div>
      </div>
      
      <div id="attribute-i-datetime_class" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">datetime_class</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><a href="../Sequel.html"><code>Sequel</code></a> can use either <code>Time</code> or <code>DateTime</code> for times returned from the database.  It defaults to <code>Time</code>.  To change it to <code>DateTime</code>:</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">datetime_class</span> = <span class="ruby-constant">DateTime</span>
</pre>

<p>Note that <code>Time</code> and <code>DateTime</code> objects have a different API, and in cases where they implement the same methods, they often implement them differently (e.g. + using seconds on <code>Time</code> and days on <code>DateTime</code>).</p>
        
        </div>
      </div>
      
      <div id="attribute-i-single_threaded" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">single_threaded</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Set whether <a href="../Sequel.html"><code>Sequel</code></a> is being used in single threaded mode. By default, <a href="../Sequel.html"><code>Sequel</code></a> uses a thread-safe connection pool, which isn&#39;t as fast as the single threaded connection pool, and also has some additional thread safety checks.  If your program will only have one thread, and speed is a priority, you should set this to true:</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">single_threaded</span> = <span class="ruby-keyword">true</span>
</pre>
        
        </div>
      </div>
      
      <div id="attribute-i-typecast_timezone" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">typecast_timezone</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The timezone that incoming data that <a href="../Sequel.html"><code>Sequel</code></a> needs to typecast is assumed to be already in (if they don&#39;t include an offset).</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-application_to_database_timestamp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">application_to_database_timestamp</span><span
            class="method-args">(v)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Convert the given <code>Time</code>/<code>DateTime</code> object into the database timezone, used when literalizing objects in an <a href="SQL.html"><code>SQL</code></a> string.</p>
          
          

          
          <div class="method-source-code" id="application_to_database_timestamp-source">
            <pre>   <span class="ruby-comment"># File lib/sequel/timezones.rb</span>
<span class="line-num">50</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">application_to_database_timestamp</span>(<span class="ruby-identifier">v</span>)
<span class="line-num">51</span>   <span class="ruby-identifier">convert_output_timestamp</span>(<span class="ruby-identifier">v</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">database_timezone</span>)
<span class="line-num">52</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-condition_specifier-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">condition_specifier?</span><span
            class="method-args">(obj)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if the passed object could be a specifier of conditions, false otherwise. Currently, <a href="../Sequel.html"><code>Sequel</code></a> considers hashes and arrays of two element arrays as condition specifiers.</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">condition_specifier?</span>({}) <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">condition_specifier?</span>([[<span class="ruby-value">1</span>, <span class="ruby-value">2</span>]]) <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">condition_specifier?</span>([]) <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">condition_specifier?</span>([<span class="ruby-value">1</span>]) <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">condition_specifier?</span>(<span class="ruby-value">1</span>) <span class="ruby-comment"># =&gt; false</span>
</pre>
          
          

          
          <div class="method-source-code" id="condition_specifier-3F-source">
            <pre>   <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">83</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">condition_specifier?</span>(<span class="ruby-identifier">obj</span>)
<span class="line-num">84</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">obj</span>
<span class="line-num">85</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
<span class="line-num">86</span>     <span class="ruby-keyword">true</span>
<span class="line-num">87</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
<span class="line-num">88</span>     <span class="ruby-operator">!</span><span class="ruby-identifier">obj</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">obj</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">SQL</span><span class="ruby-operator">::</span><span class="ruby-constant">ValueList</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">i</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>)}
<span class="line-num">89</span>   <span class="ruby-keyword">else</span>
<span class="line-num">90</span>     <span class="ruby-keyword">false</span>
<span class="line-num">91</span>   <span class="ruby-keyword">end</span>
<span class="line-num">92</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-connect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">connect</span><span
            class="method-args">(*args, &amp;block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new database object based on the supplied connection string and optional arguments.  The specified scheme determines the database class used, and the rest of the string specifies the connection options. For example:</p>

<pre class="ruby"><span class="ruby-constant">DB</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;sqlite:/&#39;</span>) <span class="ruby-comment"># Memory database</span>
<span class="ruby-constant">DB</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;sqlite://blog.db&#39;</span>) <span class="ruby-comment"># ./blog.db</span>
<span class="ruby-constant">DB</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;sqlite:///blog.db&#39;</span>) <span class="ruby-comment"># /blog.db</span>
<span class="ruby-constant">DB</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;postgres://user:password@host:port/database_name&#39;</span>)
<span class="ruby-constant">DB</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;sqlite:///blog.db&#39;</span>, <span class="ruby-value">max_connections:</span> <span class="ruby-value">10</span>)
</pre>

<p>You can also pass a single options hash:</p>

<pre class="ruby"><span class="ruby-constant">DB</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-value">adapter:</span> <span class="ruby-string">&#39;sqlite&#39;</span>, <span class="ruby-value">database:</span> <span class="ruby-string">&#39;./blog.db&#39;</span>)
</pre>

<p>If a block is given, it is passed the opened <code>Database</code> object, which is closed when the block exits.  For example:</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-string">&#39;sqlite://blog.db&#39;</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">db</span><span class="ruby-operator">|</span> <span class="ruby-identifier">puts</span> <span class="ruby-identifier">db</span>[<span class="ruby-value">:users</span>].<span class="ruby-identifier">count</span>}
</pre>

<p>If a block is not given, a reference to this database will be held in <code>Sequel::DATABASES</code> until it is removed manually.  This is by design, and used by <code>Sequel::Model</code> to pick the default database.  It is recommended to pass a block if you do not want the resulting <a href="Database.html"><code>Database</code></a> object to remain in memory until the process terminates, or use the <code>keep_reference: false</code> <a href="Database.html"><code>Database</code></a> option.</p>

<p>For details, see the <a href="../doc/opening_databases_rdoc.html">“Connecting to a Database” guide</a>. To set up a primary/replica or sharded database connection, see the <a href="../doc/sharding_rdoc.html">“Primary/Replica Database Configurations and Sharding” guide</a>.</p>
          
          

          
          <div class="method-source-code" id="connect-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">123</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">connect</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">124</span>   <span class="ruby-constant">Database</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">125</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-convert_exception_class" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_exception_class</span><span
            class="method-args">(exception, klass)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Convert the <code>exception</code> to the given class.  The given class should be <code>Sequel::Error</code> or a subclass.  Returns an instance of <code>klass</code> with the message and backtrace of <code>exception</code>.</p>
          
          

          
          <div class="method-source-code" id="convert_exception_class-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">136</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_exception_class</span>(<span class="ruby-identifier">exception</span>, <span class="ruby-identifier">klass</span>)
<span class="line-num">137</span>   <span class="ruby-keyword">return</span> <span class="ruby-identifier">exception</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">klass</span>)
<span class="line-num">138</span>   <span class="ruby-identifier">e</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{exception.class}: #{exception.message}&quot;</span>)
<span class="line-num">139</span>   <span class="ruby-identifier">e</span>.<span class="ruby-identifier">wrapped_exception</span> = <span class="ruby-identifier">exception</span>
<span class="line-num">140</span>   <span class="ruby-identifier">e</span>.<span class="ruby-identifier">set_backtrace</span>(<span class="ruby-identifier">exception</span>.<span class="ruby-identifier">backtrace</span>)
<span class="line-num">141</span>   <span class="ruby-identifier">e</span>
<span class="line-num">142</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-convert_output_timestamp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_output_timestamp</span><span
            class="method-args">(v, output_timezone)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Converts the object to the given <code>output_timezone</code>.</p>
          
          

          
          <div class="method-source-code" id="convert_output_timestamp-source">
            <pre>   <span class="ruby-comment"># File lib/sequel/timezones.rb</span>
<span class="line-num">55</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_output_timestamp</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">output_timezone</span>)
<span class="line-num">56</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">output_timezone</span>
<span class="line-num">57</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">DateTime</span>)
<span class="line-num">58</span>       <span class="ruby-keyword">case</span> <span class="ruby-identifier">output_timezone</span>
<span class="line-num">59</span>       <span class="ruby-keyword">when</span> <span class="ruby-value">:utc</span>
<span class="line-num">60</span>         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">new_offset</span>(<span class="ruby-value">0</span>)
<span class="line-num">61</span>       <span class="ruby-keyword">when</span> <span class="ruby-value">:local</span>
<span class="line-num">62</span>         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">new_offset</span>(<span class="ruby-identifier">local_offset_for_datetime</span>(<span class="ruby-identifier">v</span>))
<span class="line-num">63</span>       <span class="ruby-keyword">else</span>
<span class="line-num">64</span>         <span class="ruby-identifier">convert_output_datetime_other</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">output_timezone</span>)
<span class="line-num">65</span>       <span class="ruby-keyword">end</span>
<span class="line-num">66</span>     <span class="ruby-keyword">else</span>
<span class="line-num">67</span>       <span class="ruby-keyword">case</span> <span class="ruby-identifier">output_timezone</span>
<span class="line-num">68</span>       <span class="ruby-keyword">when</span> <span class="ruby-value">:utc</span>
<span class="line-num">69</span>         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">getutc</span>
<span class="line-num">70</span>       <span class="ruby-keyword">when</span> <span class="ruby-value">:local</span>
<span class="line-num">71</span>         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">getlocal</span>
<span class="line-num">72</span>       <span class="ruby-keyword">else</span>
<span class="line-num">73</span>         <span class="ruby-identifier">convert_output_time_other</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">output_timezone</span>)
<span class="line-num">74</span>       <span class="ruby-keyword">end</span>
<span class="line-num">75</span>     <span class="ruby-keyword">end</span>
<span class="line-num">76</span>   <span class="ruby-keyword">else</span>
<span class="line-num">77</span>     <span class="ruby-identifier">v</span>
<span class="line-num">78</span>   <span class="ruby-keyword">end</span>
<span class="line-num">79</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-convert_timestamp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">convert_timestamp</span><span
            class="method-args">(v, input_timezone)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Converts the given object from the given input timezone to the <code>application_timezone</code> using <code>convert_input_timestamp</code> and <code>convert_output_timestamp</code>.</p>
          
          

          
          <div class="method-source-code" id="convert_timestamp-source">
            <pre>   <span class="ruby-comment"># File lib/sequel/timezones.rb</span>
<span class="line-num">84</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_timestamp</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">input_timezone</span>)
<span class="line-num">85</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Date</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">DateTime</span>)
<span class="line-num">86</span>     <span class="ruby-comment"># Dates handled specially as they are assumed to already be in the application_timezone</span>
<span class="line-num">87</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">datetime_class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">DateTime</span>
<span class="line-num">88</span>       <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">civil</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">year</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">month</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">day</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span>, <span class="ruby-identifier">application_timezone</span> <span class="ruby-operator">==</span> <span class="ruby-value">:local</span> <span class="ruby-operator">?</span> <span class="ruby-constant">Rational</span>(<span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">year</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">month</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">day</span>).<span class="ruby-identifier">utc_offset</span>, <span class="ruby-value">86400</span>) <span class="ruby-operator">:</span> <span class="ruby-value">0</span>)
<span class="line-num">89</span>     <span class="ruby-keyword">else</span>
<span class="line-num">90</span>       <span class="ruby-constant">Time</span>.<span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">application_timezone</span> <span class="ruby-operator">==</span> <span class="ruby-value">:utc</span> <span class="ruby-operator">?</span> <span class="ruby-value">:utc</span> <span class="ruby-operator">:</span> <span class="ruby-value">:local</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">year</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">month</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">day</span>)
<span class="line-num">91</span>     <span class="ruby-keyword">end</span>
<span class="line-num">92</span>   <span class="ruby-keyword">else</span>
<span class="line-num">93</span>     <span class="ruby-identifier">convert_output_timestamp</span>(<span class="ruby-identifier">convert_input_timestamp</span>(<span class="ruby-identifier">v</span>, <span class="ruby-identifier">input_timezone</span>), <span class="ruby-identifier">application_timezone</span>)
<span class="line-num">94</span>   <span class="ruby-keyword">end</span>
<span class="line-num">95</span> <span class="ruby-keyword">rescue</span> <span class="ruby-constant">InvalidValue</span>
<span class="line-num">96</span>   <span class="ruby-identifier">raise</span>
<span class="line-num">97</span> <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">98</span>   <span class="ruby-identifier">raise</span> <span class="ruby-identifier">convert_exception_class</span>(<span class="ruby-identifier">e</span>, <span class="ruby-constant">InvalidValue</span>)
<span class="line-num">99</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-core_extensions-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">core_extensions?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Assume the core extensions are not loaded by default, if the <a href="../doc/core_extensions_rdoc.html">core_extensions</a> extension is loaded, this will be overridden.</p>
          
          

          
          <div class="method-source-code" id="core_extensions-3F-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">129</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">core_extensions?</span>
<span class="line-num">130</span>   <span class="ruby-keyword">false</span>
<span class="line-num">131</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-current" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The current concurrency primitive, Thread.current by default.</p>
          
          

          
          <div class="method-source-code" id="current-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">145</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">current</span>
<span class="line-num">146</span>   <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">current</span>
<span class="line-num">147</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-database_to_application_timestamp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">database_to_application_timestamp</span><span
            class="method-args">(v)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Convert the given object into an object of <code>Sequel.datetime_class</code> in the <code>application_timezone</code>.  Used when converting datetime/timestamp columns returned by the database.</p>
          
          

          
          <div class="method-source-code" id="database_to_application_timestamp-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/timezones.rb</span>
<span class="line-num">104</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">database_to_application_timestamp</span>(<span class="ruby-identifier">v</span>)
<span class="line-num">105</span>   <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">v</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">database_timezone</span>)
<span class="line-num">106</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-default_timezone-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default_timezone=</span><span
            class="method-args">(tz)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets the database, application, and typecasting timezones to the given timezone.</p>
          
          

          
          <div class="method-source-code" id="default_timezone-3D-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/timezones.rb</span>
<span class="line-num">109</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">default_timezone=</span>(<span class="ruby-identifier">tz</span>)
<span class="line-num">110</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">database_timezone</span> = <span class="ruby-identifier">tz</span>
<span class="line-num">111</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">application_timezone</span> = <span class="ruby-identifier">tz</span>
<span class="line-num">112</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">typecast_timezone</span> = <span class="ruby-identifier">tz</span>
<span class="line-num">113</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-elapsed_seconds_since" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">elapsed_seconds_since</span><span
            class="method-args">(timer)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The elapsed seconds since the given timer object was created.  The timer object should have been created via Sequel.start_timer.</p>
          
          

          
          <div class="method-source-code" id="elapsed_seconds_since-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">335</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">elapsed_seconds_since</span>(<span class="ruby-identifier">timer</span>)
<span class="line-num">336</span>   <span class="ruby-identifier">start_timer</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">timer</span>
<span class="line-num">337</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-extension" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">extension</span><span
            class="method-args">(*extensions)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Load all <a href="../Sequel.html"><code>Sequel</code></a> extensions given.  Extensions are just files that exist under <code>sequel/extensions</code> in the load path, and are just required.</p>

<p>In some cases, requiring an extension modifies classes directly, and in others, it just loads a module that you can extend other classes with.  Consult the documentation for each extension you plan on using for usage.</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">extension</span>(<span class="ruby-value">:blank</span>)
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">extension</span>(<span class="ruby-value">:core_extensions</span>, <span class="ruby-value">:named_timezones</span>)
</pre>
          
          

          
          <div class="method-source-code" id="extension-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">157</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extension</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">extensions</span>)
<span class="line-num">158</span>   <span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">orig_require</span>(<span class="ruby-node">&quot;sequel/extensions/#{e}&quot;</span>)}
<span class="line-num">159</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-json_parser_error_class" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">json_parser_error_class</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The exception classed raised if there is an error parsing JSON. This can be overridden to use an alternative json implementation.</p>
          
          

          
          <div class="method-source-code" id="json_parser_error_class-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">163</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">json_parser_error_class</span>
<span class="line-num">164</span>   <span class="ruby-constant">JSON</span><span class="ruby-operator">::</span><span class="ruby-constant">ParserError</span>
<span class="line-num">165</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-object_to_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">object_to_json</span><span
            class="method-args">(obj, *args, &amp;block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Convert given object to json and return the result. This can be overridden to use an alternative json implementation.</p>
          
          

          
          <div class="method-source-code" id="object_to_json-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">169</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">object_to_json</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">170</span>   <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_json</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">171</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-orig_require" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">orig_require</span><span
            class="method-args">(files, subdir=nil)</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Alias of original require method, as Sequel.require does a relative require for backwards compatibility.</p>
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="SequelMethods.html#method-i-require">require</a>
        </div>
        
      </div>

    
      <div id="method-i-parse_json" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_json</span><span
            class="method-args">(json)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Parse the string as JSON and return the result. This can be overridden to use an alternative json implementation.</p>
          
          

          
          <div class="method-source-code" id="parse_json-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">175</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">parse_json</span>(<span class="ruby-identifier">json</span>)
<span class="line-num">176</span>   <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">json</span>, <span class="ruby-value">:create_additions</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">false</span>)
<span class="line-num">177</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-recursive_map" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">recursive_map</span><span
            class="method-args">(array, converter)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Convert each item in the array to the correct type, handling multi-dimensional arrays.  For each element in the array or subarrays, call the converter, unless the value is nil.</p>
          
          

          
          <div class="method-source-code" id="recursive_map-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">193</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recursive_map</span>(<span class="ruby-identifier">array</span>, <span class="ruby-identifier">converter</span>)
<span class="line-num">194</span>   <span class="ruby-identifier">array</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
<span class="line-num">195</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">196</span>       <span class="ruby-identifier">recursive_map</span>(<span class="ruby-identifier">i</span>, <span class="ruby-identifier">converter</span>)
<span class="line-num">197</span>     <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">i</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">198</span>       <span class="ruby-identifier">converter</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">i</span>)
<span class="line-num">199</span>     <span class="ruby-keyword">end</span>
<span class="line-num">200</span>   <span class="ruby-keyword">end</span>
<span class="line-num">201</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-require" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">require</span><span
            class="method-args">(files, subdir=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>For backwards compatibility only.  require_relative should be used instead.</p>
          
          

          
          <div class="method-source-code" id="require-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">204</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require</span>(<span class="ruby-identifier">files</span>, <span class="ruby-identifier">subdir</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">205</span>   <span class="ruby-comment"># Use Kernel.require_relative to work around JRuby 9.0 bug</span>
<span class="line-num">206</span>   <span class="ruby-constant">Array</span>(<span class="ruby-identifier">files</span>).<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-constant">Kernel</span>.<span class="ruby-identifier">require_relative</span> <span class="ruby-node">&quot;#{&quot;#{subdir}/&quot; if subdir}#{f}&quot;</span>}
<span class="line-num">207</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="SequelMethods.html#method-i-orig_require">orig_require</a>
        </div>
        

        
      </div>

    
      <div id="method-i-split_symbol" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">split_symbol</span><span
            class="method-args">(sym)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Splits the symbol into three parts, if symbol splitting is enabled (not the default). Each part will either be a string or nil. If symbol splitting is disabled, returns an array with the first and third parts being nil, and the second part beind a string version of the symbol.</p>

<p>For columns, these parts are the table, column, and alias. For tables, these parts are the schema, table, and alias.</p>
          
          

          
          <div class="method-source-code" id="split_symbol-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">216</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">split_symbol</span>(<span class="ruby-identifier">sym</span>)
<span class="line-num">217</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-constant">SPLIT_SYMBOL_CACHE</span>[<span class="ruby-identifier">sym</span>]}
<span class="line-num">218</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">split_symbols?</span>
<span class="line-num">219</span>       <span class="ruby-identifier">v</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">s</span> = <span class="ruby-identifier">sym</span>.<span class="ruby-identifier">to_s</span>
<span class="line-num">220</span>       <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A((?:(?!__).)+)__((?:(?!___).)+)___(.+)\z/</span>
<span class="line-num">221</span>         [<span class="ruby-node">$1</span>.<span class="ruby-identifier">freeze</span>, <span class="ruby-node">$2</span>.<span class="ruby-identifier">freeze</span>, <span class="ruby-node">$3</span>.<span class="ruby-identifier">freeze</span>].<span class="ruby-identifier">freeze</span>
<span class="line-num">222</span>       <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A((?:(?!___).)+)___(.+)\z/</span>
<span class="line-num">223</span>         [<span class="ruby-keyword">nil</span>, <span class="ruby-node">$1</span>.<span class="ruby-identifier">freeze</span>, <span class="ruby-node">$2</span>.<span class="ruby-identifier">freeze</span>].<span class="ruby-identifier">freeze</span>
<span class="line-num">224</span>       <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A((?:(?!__).)+)__(.+)\z/</span>
<span class="line-num">225</span>         [<span class="ruby-node">$1</span>.<span class="ruby-identifier">freeze</span>, <span class="ruby-node">$2</span>.<span class="ruby-identifier">freeze</span>, <span class="ruby-keyword">nil</span>].<span class="ruby-identifier">freeze</span>
<span class="line-num">226</span>       <span class="ruby-keyword">else</span>
<span class="line-num">227</span>         [<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">s</span>.<span class="ruby-identifier">freeze</span>, <span class="ruby-keyword">nil</span>].<span class="ruby-identifier">freeze</span>
<span class="line-num">228</span>       <span class="ruby-keyword">end</span>
<span class="line-num">229</span>     <span class="ruby-keyword">else</span>
<span class="line-num">230</span>       <span class="ruby-identifier">v</span> = [<span class="ruby-keyword">nil</span>,<span class="ruby-identifier">sym</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">freeze</span>,<span class="ruby-keyword">nil</span>].<span class="ruby-identifier">freeze</span>
<span class="line-num">231</span>     <span class="ruby-keyword">end</span>
<span class="line-num">232</span>     <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-constant">SPLIT_SYMBOL_CACHE</span>[<span class="ruby-identifier">sym</span>] = <span class="ruby-identifier">v</span>}
<span class="line-num">233</span>   <span class="ruby-keyword">end</span>
<span class="line-num">234</span>   <span class="ruby-identifier">v</span>
<span class="line-num">235</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-split_symbols-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">split_symbols=</span><span
            class="method-args">(v)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Setting this to true enables Sequel&#39;s historical behavior of splitting symbols on double or triple underscores:</p>

<pre class="ruby"><span class="ruby-value">:table__column</span>         <span class="ruby-comment"># table.column</span>
<span class="ruby-value">:column___alias</span>        <span class="ruby-comment"># column AS alias</span>
<span class="ruby-value">:table__column___alias</span> <span class="ruby-comment"># table.column AS alias</span>
</pre>

<p>It is only recommended to turn this on for backwards compatibility until such symbols have been converted to use newer <a href="../Sequel.html"><code>Sequel</code></a> APIs such as:</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>[<span class="ruby-value">:table</span>][<span class="ruby-value">:column</span>]            <span class="ruby-comment"># table.column</span>
<span class="ruby-constant">Sequel</span>[<span class="ruby-value">:column</span>].<span class="ruby-identifier">as</span>(<span class="ruby-value">:alias</span>)         <span class="ruby-comment"># column AS alias</span>
<span class="ruby-constant">Sequel</span>[<span class="ruby-value">:table</span>][<span class="ruby-value">:column</span>].<span class="ruby-identifier">as</span>(<span class="ruby-value">:alias</span>) <span class="ruby-comment"># table.column AS alias</span>
</pre>

<p><a href="Database.html"><code>Sequel::Database</code></a> instances do their own caching of literalized symbols, and changing this setting does not affect those caches.  It is recommended that if you want to change this setting, you do so directly after requiring <a href="../Sequel.html"><code>Sequel</code></a>, before creating any <a href="Database.html"><code>Sequel::Database</code></a> instances.</p>

<p>Disabling symbol splitting will also disable the handling of double underscores in virtual row methods, causing such methods to yield regular identifers instead of qualified identifiers:</p>

<pre class="ruby"><span class="ruby-comment"># Sequel.split_symbols = true</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>{<span class="ruby-identifier">table__column</span>}  <span class="ruby-comment"># table.column</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>{<span class="ruby-identifier">table</span>[<span class="ruby-value">:column</span>]} <span class="ruby-comment"># table.column</span>

<span class="ruby-comment"># Sequel.split_symbols = false</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>{<span class="ruby-identifier">table__column</span>}  <span class="ruby-comment"># table__column</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>{<span class="ruby-identifier">table</span>[<span class="ruby-value">:column</span>]} <span class="ruby-comment"># table.column</span>
</pre>
          
          

          
          <div class="method-source-code" id="split_symbols-3D-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">267</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">split_symbols=</span>(<span class="ruby-identifier">v</span>)
<span class="line-num">268</span>   <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-constant">SPLIT_SYMBOL_CACHE</span>.<span class="ruby-identifier">clear</span>}
<span class="line-num">269</span>   <span class="ruby-ivar">@split_symbols</span> = <span class="ruby-identifier">v</span>
<span class="line-num">270</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-split_symbols-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">split_symbols?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Whether <a href="../Sequel.html"><code>Sequel</code></a> currently splits symbols into qualified/aliased identifiers.</p>
          
          

          
          <div class="method-source-code" id="split_symbols-3F-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">273</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">split_symbols?</span>
<span class="line-num">274</span>   <span class="ruby-ivar">@split_symbols</span>
<span class="line-num">275</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-start_timer" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">start_timer</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A timer object that can be passed to Sequel.elapsed_seconds_since to return the number of seconds elapsed.</p>
          
          

          
          <div class="method-source-code" id="start_timer-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">322</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">start_timer</span>
<span class="line-num">323</span>   <span class="ruby-constant">Process</span>.<span class="ruby-identifier">clock_gettime</span>(<span class="ruby-constant">Process</span><span class="ruby-operator">::</span><span class="ruby-constant">CLOCK_MONOTONIC</span>)
<span class="line-num">324</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-string_to_date" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">string_to_date</span><span
            class="method-args">(string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Converts the given <code>string</code> into a <code>Date</code> object.</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">string_to_date</span>(<span class="ruby-string">&#39;2010-09-10&#39;</span>) <span class="ruby-comment"># Date.civil(2010, 09, 10)</span>
</pre>
          
          

          
          <div class="method-source-code" id="string_to_date-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">280</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">string_to_date</span>(<span class="ruby-identifier">string</span>)
<span class="line-num">281</span>   <span class="ruby-constant">Date</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">string</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">convert_two_digit_years</span>)
<span class="line-num">282</span> <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">283</span>   <span class="ruby-identifier">raise</span> <span class="ruby-identifier">convert_exception_class</span>(<span class="ruby-identifier">e</span>, <span class="ruby-constant">InvalidValue</span>)
<span class="line-num">284</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-string_to_datetime" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">string_to_datetime</span><span
            class="method-args">(string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Converts the given <code>string</code> into a <code>Time</code> or <code>DateTime</code> object, depending on the value of <code>Sequel.datetime_class</code>.</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">string_to_datetime</span>(<span class="ruby-string">&#39;2010-09-10 10:20:30&#39;</span>) <span class="ruby-comment"># Time.local(2010, 09, 10, 10, 20, 30)</span>
</pre>
          
          

          
          <div class="method-source-code" id="string_to_datetime-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">290</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">string_to_datetime</span>(<span class="ruby-identifier">string</span>)
<span class="line-num">291</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">datetime_class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">DateTime</span>
<span class="line-num">292</span>     <span class="ruby-constant">DateTime</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">convert_two_digit_years</span>)
<span class="line-num">293</span>   <span class="ruby-keyword">else</span>
<span class="line-num">294</span>     <span class="ruby-identifier">datetime_class</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">string</span>)
<span class="line-num">295</span>   <span class="ruby-keyword">end</span>
<span class="line-num">296</span> <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">297</span>   <span class="ruby-identifier">raise</span> <span class="ruby-identifier">convert_exception_class</span>(<span class="ruby-identifier">e</span>, <span class="ruby-constant">InvalidValue</span>)
<span class="line-num">298</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-string_to_time" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">string_to_time</span><span
            class="method-args">(string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Converts the given <code>string</code> into a <code>Sequel::SQLTime</code> object.</p>

<pre class="ruby"><span class="ruby-identifier">v</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">string_to_time</span>(<span class="ruby-string">&#39;10:20:30&#39;</span>) <span class="ruby-comment"># Sequel::SQLTime.parse(&#39;10:20:30&#39;)</span>
<span class="ruby-constant">DB</span>.<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">v</span>) <span class="ruby-comment"># =&gt; &#39;10:20:30&#39;</span>
</pre>
          
          

          
          <div class="method-source-code" id="string_to_time-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">304</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">string_to_time</span>(<span class="ruby-identifier">string</span>)
<span class="line-num">305</span>   <span class="ruby-constant">SQLTime</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">string</span>)
<span class="line-num">306</span> <span class="ruby-keyword">rescue</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">307</span>   <span class="ruby-identifier">raise</span> <span class="ruby-identifier">convert_exception_class</span>(<span class="ruby-identifier">e</span>, <span class="ruby-constant">InvalidValue</span>)
<span class="line-num">308</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-synchronize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">synchronize</span><span
            class="method-args">() { |: synchronize(&amp;block)| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Unless in single threaded mode, protects access to any mutable global data structure in <a href="../Sequel.html"><code>Sequel</code></a>. Uses a non-reentrant mutex, so calling code should be careful. In general, this should only be used around the minimal possible code such as Hash#[], Hash#[]=, Hash#delete, Array#<<, and Array#delete.</p>
          
          

          
          <div class="method-source-code" id="synchronize-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">315</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">synchronize</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">316</span>   <span class="ruby-ivar">@single_threaded</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">yield</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@data_mutex</span>.<span class="ruby-identifier">synchronize</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">317</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-synchronize_with" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">synchronize_with</span><span
            class="method-args">(mutex) { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If a mutex is given, synchronize access using it.  If nil is given, just yield to the block.  This is designed for cases where a mutex may or may not be provided.</p>
          
          

          
          <div class="method-source-code" id="synchronize_with-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">182</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">synchronize_with</span>(<span class="ruby-identifier">mutex</span>)
<span class="line-num">183</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">mutex</span>
<span class="line-num">184</span>     <span class="ruby-identifier">mutex</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-keyword">yield</span>}
<span class="line-num">185</span>   <span class="ruby-keyword">else</span>
<span class="line-num">186</span>     <span class="ruby-keyword">yield</span>
<span class="line-num">187</span>   <span class="ruby-keyword">end</span>
<span class="line-num">188</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-transaction" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">transaction</span><span
            class="method-args">(dbs, opts=OPTS, &amp;block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Uses a transaction on all given databases with the given options. This:</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">transaction</span>([<span class="ruby-constant">DB1</span>, <span class="ruby-constant">DB2</span>, <span class="ruby-constant">DB3</span>]){}
</pre>

<p>is equivalent to:</p>

<pre class="ruby"><span class="ruby-constant">DB1</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
  <span class="ruby-constant">DB2</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
    <span class="ruby-constant">DB3</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>except that if Sequel::Rollback is raised by the block, the transaction is rolled back on all databases instead of just the last one.</p>

<p>Note that this method cannot guarantee that all databases will commit or rollback.  For example, if DB3 commits but attempting to commit on DB2 fails (maybe because foreign key checks are deferred), there is no way to uncommit the changes on DB3.  For that kind of support, you need to have two-phase commit/prepared transactions (which <a href="../Sequel.html"><code>Sequel</code></a> supports on some databases).</p>
          
          

          
          <div class="method-source-code" id="transaction-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">361</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">transaction</span>(<span class="ruby-identifier">dbs</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">362</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:rollback</span>]
<span class="line-num">363</span>     <span class="ruby-identifier">rescue_rollback</span> = <span class="ruby-keyword">true</span>
<span class="line-num">364</span>     <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:rollback</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:reraise</span>)
<span class="line-num">365</span>   <span class="ruby-keyword">end</span>
<span class="line-num">366</span>   <span class="ruby-identifier">pr</span> = <span class="ruby-identifier">dbs</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-identifier">block</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">bl</span>, <span class="ruby-identifier">db</span><span class="ruby-operator">|</span> <span class="ruby-identifier">proc</span>{<span class="ruby-identifier">db</span>.<span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">bl</span>)}}
<span class="line-num">367</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">rescue_rollback</span>
<span class="line-num">368</span>     <span class="ruby-keyword">begin</span>
<span class="line-num">369</span>       <span class="ruby-identifier">pr</span>.<span class="ruby-identifier">call</span>
<span class="line-num">370</span>     <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Rollback</span>
<span class="line-num">371</span>       <span class="ruby-keyword">nil</span>
<span class="line-num">372</span>     <span class="ruby-keyword">end</span>
<span class="line-num">373</span>   <span class="ruby-keyword">else</span>
<span class="line-num">374</span>     <span class="ruby-identifier">pr</span>.<span class="ruby-identifier">call</span>
<span class="line-num">375</span>   <span class="ruby-keyword">end</span>
<span class="line-num">376</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-typecast_to_application_timestamp" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">typecast_to_application_timestamp</span><span
            class="method-args">(v)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Convert the given object into an object of <code>Sequel.datetime_class</code> in the <code>application_timezone</code>.  Used when typecasting values when assigning them to model datetime attributes.</p>
          
          

          
          <div class="method-source-code" id="typecast_to_application_timestamp-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/timezones.rb</span>
<span class="line-num">118</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">typecast_to_application_timestamp</span>(<span class="ruby-identifier">v</span>)
<span class="line-num">119</span>   <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">v</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">typecast_timezone</span>)
<span class="line-num">120</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-virtual_row" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">virtual_row</span><span
            class="method-args">(&amp;block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If the supplied block takes a single argument, yield an <code>SQL::VirtualRow</code> instance to the block argument.  Otherwise, evaluate the block in the context of a <code>SQL::VirtualRow</code> instance.</p>

<pre class="ruby"><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">virtual_row</span>{<span class="ruby-identifier">a</span>} <span class="ruby-comment"># Sequel::SQL::Identifier.new(:a)</span>
<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">virtual_row</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">a</span>} <span class="ruby-comment"># Sequel::SQL::Function.new(:a)</span>
</pre>
          
          

          
          <div class="method-source-code" id="virtual_row-source">
            <pre>    <span class="ruby-comment"># File lib/sequel/core.rb</span>
<span class="line-num">385</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">virtual_row</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">386</span>   <span class="ruby-identifier">vr</span> = <span class="ruby-constant">VIRTUAL_ROW</span>
<span class="line-num">387</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">arity</span>
<span class="line-num">388</span>   <span class="ruby-keyword">when</span> <span class="ruby-value">-1</span>, <span class="ruby-value">0</span>
<span class="line-num">389</span>     <span class="ruby-identifier">vr</span>.<span class="ruby-identifier">instance_exec</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">390</span>   <span class="ruby-keyword">else</span>
<span class="line-num">391</span>     <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">vr</span>)
<span class="line-num">392</span>   <span class="ruby-keyword">end</span>  
<span class="line-num">393</span> <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.1.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

